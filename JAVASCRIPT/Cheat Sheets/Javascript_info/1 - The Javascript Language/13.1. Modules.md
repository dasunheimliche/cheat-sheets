## A - Modules, introduction

#### 1. **Definicion:**

Los m√≥dulos son archivos que dividen una aplicaci√≥n grande en partes m√°s peque√±as y manejables. Cada m√≥dulo puede contener clases o funciones para un prop√≥sito espec√≠fico. Los m√≥dulos usan `export` para hacer accesibles funciones y variables desde fuera del m√≥dulo, e `import` para usar funcionalidades de otros m√≥dulos.

## B - What is a module?

#### 1. **Definicion:**

Un m√≥dulo es simplemente un archivo. Un script es un m√≥dulo. Los m√≥dulos usan `export` para hacer accesibles funciones y variables desde fuera del m√≥dulo, e `import` para usar funcionalidades de otros m√≥dulos.

#### 2. **Ejemplo:**

```javascript
// üìÅ sayHi.js
export function sayHi(user) {
  alert(`Hello, ${user}!`);
}
```

```javascript
// üìÅ main.js
import { sayHi } from "./sayHi.js";

alert(sayHi); // function...
sayHi("John"); // Hello, John!
```

**Explicaci√≥n del ejemplo**:
`sayHi.js` exporta la funci√≥n `sayHi`, y `main.js` la importa y la usa. Para que esto funcione en el navegador, el script debe tener el atributo `<script type="module">`.

## C - Core module features

#### 1. **Definicion:**

Los m√≥dulos tienen caracter√≠sticas especiales que los diferencian de los scripts regulares, como el modo estricto, el alcance de nivel de m√≥dulo y la evaluaci√≥n √∫nica.

### 1. Always ‚Äúuse strict‚Äù

#### 1. **Definicion:**

Los m√≥dulos siempre funcionan en modo estricto. Esto significa que, por ejemplo, asignar a una variable no declarada dar√° un error.

#### 2. **Ejemplo:**

```html
<script type="module">
  a = 5; // Error
</script>
```

**Explicaci√≥n del ejemplo**:
En un m√≥dulo, asignar a una variable no declarada genera un error debido al modo estricto.

### 2. Module-level scope

#### 1. **Definicion:**

Cada m√≥dulo tiene su propio alcance de nivel superior. Las variables y funciones de un m√≥dulo no son visibles en otros scripts.

#### 2. **Ejemplo:**

```html
<!-- index.html -->
<script type="module" src="user.js"></script>
<script type="module" src="hello.js"></script>
```

```javascript
// üìÅ user.js
let user = "John";
```

```javascript
// üìÅ hello.js
alert(user); // Error: user is not defined
```

**Explicaci√≥n del ejemplo**:
La variable `user` definida en `user.js` no es visible en `hello.js` porque cada m√≥dulo tiene su propio alcance.

#### 3. **Ejemplo correcto:**

```javascript
// üìÅ hello.js
import { user } from "./user.js";
document.body.innerHTML = user; // John
```

```javascript
// üìÅ user.js
export let user = "John";
```

**Explicaci√≥n del ejemplo**:
Para que `hello.js` pueda usar la variable `user`, `user.js` debe exportarla y `hello.js` debe importarla.

### 3. A module code is evaluated only the first time when imported

#### 1. **Definicion:**

Si el mismo m√≥dulo se importa en varios otros m√≥dulos, su c√≥digo se ejecuta solo una vez, en la primera importaci√≥n. Luego, sus exportaciones se entregan a todos los dem√°s importadores.

#### 2. **Ejemplo:**

```javascript
// üìÅ alert.js
alert("Module is evaluated!");
```

```javascript
// üìÅ 1.js
import "./alert.js"; // Module is evaluated!
```

```javascript
// üìÅ 2.js
import "./alert.js"; // (no muestra nada)
```

**Explicaci√≥n del ejemplo**:
El mensaje "Module is evaluated!" solo se muestra una vez, en la primera importaci√≥n del m√≥dulo `alert.js`.

#### 3. **Ejemplo con objeto:**

```javascript
// üìÅ admin.js
export let admin = {
  name: "John",
};
```

```javascript
// üìÅ 1.js
import { admin } from "./admin.js";
admin.name = "Pete";
```

```javascript
// üìÅ 2.js
import { admin } from "./admin.js";
alert(admin.name); // Pete
```

**Explicaci√≥n del ejemplo**:
Ambos m√≥dulos `1.js` y `2.js` importan el mismo objeto `admin`. Cuando `1.js` cambia la propiedad `name`, `2.js` ve el cambio.

#### 4. **Ejemplo de configuraci√≥n:**

```javascript
// üìÅ admin.js
export let config = {};

export function sayHi() {
  alert(`Ready to serve, ${config.user}!`);
}
```

```javascript
// üìÅ init.js
import { config } from "./admin.js";
config.user = "Pete";
```

```javascript
// üìÅ another.js
import { sayHi } from "./admin.js";
sayHi(); // Ready to serve, Pete!
```

**Explicaci√≥n del ejemplo**:
El m√≥dulo `admin.js` exporta un objeto `config` que se configura en `init.js`. Luego, `another.js` usa la configuraci√≥n.

### 4. import.meta

#### 1. **Definicion:**

El objeto `import.meta` contiene informaci√≥n sobre el m√≥dulo actual. En el navegador, contiene la URL del script.

#### 2. **Ejemplo:**

```html
<script type="module">
  alert(import.meta.url); // URL del script
</script>
```

**Explicaci√≥n del ejemplo**:
`import.meta.url` muestra la URL del script actual.

### 5. In a module, ‚Äúthis‚Äù is undefined

#### 1. **Definicion:**

En un m√≥dulo, `this` en el nivel superior es `undefined`.

#### 2. **Ejemplo:**

```html
<script>
  alert(this); // window
</script>

<script type="module">
  alert(this); // undefined
</script>
```

**Explicaci√≥n del ejemplo**:
En un script regular, `this` es el objeto global (`window`), pero en un m√≥dulo es `undefined`.

## D - Browser-specific features

#### 1. **Definicion:**

Los m√≥dulos tienen caracter√≠sticas espec√≠ficas en el navegador, como el comportamiento diferido, el uso de `async` en scripts en l√≠nea y el manejo de scripts externos.

### 1. Module scripts are deferred

#### 1. **Definicion:**

Los scripts de m√≥dulo siempre se ejecutan de forma diferida, como si tuvieran el atributo `defer`. Esto significa que se ejecutan despu√©s de que el HTML se ha cargado completamente.

#### 2. **Ejemplo:**

```html
<script type="module">
  alert(typeof button); // object
</script>

<script>
  alert(typeof button); // undefined
</script>

<button id="button">Button</button>
```

**Explicaci√≥n del ejemplo**:
El script de m√≥dulo puede ver el bot√≥n porque se ejecuta despu√©s de que el HTML se ha cargado. El script regular no puede ver el bot√≥n porque se ejecuta inmediatamente.

### 2. Async works on inline scripts

#### 1. **Definicion:**

El atributo `async` funciona en scripts de m√≥dulo en l√≠nea, lo que permite que se ejecuten de forma as√≠ncrona sin esperar a que el HTML se cargue.

#### 2. **Ejemplo:**

```html
<script async type="module">
  import { counter } from "./analytics.js";
  counter.count();
</script>
```

**Explicaci√≥n del ejemplo**:
El script de m√≥dulo con `async` se ejecuta de forma as√≠ncrona, sin esperar a que el HTML se cargue.

### 3. External scripts

#### 1. **Definicion:**

Los scripts externos con `type="module"` se ejecutan solo una vez y requieren encabezados CORS si se obtienen de otro origen.

#### 2. **Ejemplo:**

```html
<!-- El script my.js se obtiene y ejecuta solo una vez -->
<script type="module" src="my.js"></script>
<script type="module" src="my.js"></script>

<!-- another-site.com debe proporcionar Access-Control-Allow-Origin -->
<!-- de lo contrario, el script no se ejecutar√° -->
<script type="module" src="http://another-site.com/their.js"></script>
```

**Explicaci√≥n del ejemplo**:
Los scripts externos con `type="module"` se ejecutan solo una vez y requieren encabezados CORS si se obtienen de otro origen.

### 4. No ‚Äúbare‚Äù modules allowed

#### 1. **Definicion:**

En el navegador, `import` debe obtener una URL relativa o absoluta. Los m√≥dulos sin ruta no est√°n permitidos.

#### 2. **Ejemplo:**

```javascript
import { sayHi } from "sayHi"; // Error, m√≥dulo "bare"
import { sayHi } from "./sayHi.js"; // Correcto
```

**Explicaci√≥n del ejemplo**:
Los m√≥dulos deben tener una ruta, como `./sayHi.js`, en lugar de solo el nombre del m√≥dulo.

### 5. Compatibility, ‚Äúnomodule‚Äù

#### 1. **Definicion:**

Los navegadores antiguos no entienden `type="module"`. Para ellos, puedes proporcionar un fallback usando el atributo `nomodule`.

#### 2. **Ejemplo:**

```html
<script type="module">
  alert("Runs in modern browsers");
</script>

<script nomodule>
  alert("Modern browsers know both type=module and nomodule, so skip this");
  alert(
    "Old browsers ignore script with unknown type=module, but execute this."
  );
</script>
```

**Explicaci√≥n del ejemplo**:
Los navegadores modernos ejecutan el script con `type="module"` y omiten el script con `nomodule`. Los navegadores antiguos omiten el script con `type="module"` y ejecutan el script con `nomodule`.

## E - Build tools

#### 1. **Definicion:**

En la vida real, los m√≥dulos del navegador rara vez se usan en su forma "cruda". Por lo general, se agrupan con una herramienta especial como Webpack y se implementan en el servidor de producci√≥n.

#### 2. **Proceso:**

1.  Toma un m√≥dulo "principal".
2.  Analiza sus dependencias.
3.  Construye un solo archivo con todos los m√≥dulos.
4.  Aplica transformaciones y optimizaciones.

#### 3. **Ejemplo:**

```html
<!-- Suponiendo que obtuvimos bundle.js de una herramienta como Webpack -->
<script src="bundle.js"></script>
```

**Explicaci√≥n del ejemplo**:
Los scripts se agrupan en un solo archivo, y las declaraciones `import/export` se reemplazan por funciones especiales del bundler.
