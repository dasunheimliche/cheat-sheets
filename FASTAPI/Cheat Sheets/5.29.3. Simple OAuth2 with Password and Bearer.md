## A - OAuth2PasswordBearer

**Definición:** OAuth2PasswordBearer es una clase en FastAPI que se utiliza para implementar la autenticación mediante OAuth2 con el flujo de contraseña y un token Bearer.

**Ejemplo:**

```python
from fastapi import Depends, FastAPI
from fastapi.security import OAuth2PasswordBearer

app = FastAPI()
oauth2_scheme = OAuth2PasswordBearer(tokenUrl="token")

@app.get("/items/")
async def read_items(token: str = Depends(oauth2_scheme)):
    return {"token": token}
```

En este ejemplo, OAuth2PasswordBearer se utiliza para declarar que la URL /token será la que el cliente usará para enviar el nombre de usuario y la contraseña para obtener un token.

## B - OAuth2PasswordRequestForm

**Definición:** OAuth2PasswordRequestForm es una clase en FastAPI que se utiliza para declarar un formulario de cuerpo con los campos de nombre de usuario y contraseña, y opcionalmente, un campo de alcance (scope).

**Ejemplo:**

```python
from fastapi import Depends, FastAPI
from fastapi.security import OAuth2PasswordRequestForm

app = FastAPI()

@app.post("/token")
async def login(form_data: OAuth2PasswordRequestForm = Depends()):
    return {"access_token": form_data.username, "token_type": "bearer"}
```

En este ejemplo, OAuth2PasswordRequestForm se utiliza para obtener los datos del formulario enviados por el cliente.

## C - Hashing de Contraseña

**Definición:** El hashing de contraseña es el proceso de convertir una contraseña en una secuencia de bytes que parece un galimatías, lo que hace que sea difícil revertirla a su forma original.

**Ejemplo:**

```python
def fake_hash_password(password: str):
    return "fakehashed" + password
```

En este ejemplo, fake_hash_password toma una contraseña y devuelve una versión "hash" de la misma.

## D - Decodificación de Token

**Definición:** La decodificación de token es el proceso de convertir un token en un objeto de usuario.

**Ejemplo:**

```python
def fake_decode_token(token):
    return {"username": token + "fakedecoded"}
```

En este ejemplo, fake_decode_token toma un token y devuelve un diccionario con el nombre de usuario decodificado.

## E - Obtener Usuario Actual

**Definición:** La función get_current_user se utiliza para obtener el usuario actual a partir de un token proporcionado.

**Ejemplo:**

```python
from fastapi import Depends, HTTPException, status

async def get_current_user(token: str = Depends(oauth2_scheme)):
    user = fake_decode_token(token)
    if not user:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Invalid authentication credentials",
            headers={"WWW-Authenticate": "Bearer"},
        )
    return user
```

En este ejemplo, get_current_user utiliza fake_decode_token para decodificar el token y obtener el usuario.
