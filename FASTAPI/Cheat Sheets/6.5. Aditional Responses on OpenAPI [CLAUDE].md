## A - Respuestas adicionales en OpenAPI

**Definición:**  
FastAPI permite declarar respuestas adicionales en tu API, con códigos de estado HTTP, tipos de medios (media types), descripciones, etc. Estas respuestas adicionales se incluyen en el esquema OpenAPI y aparecen en la documentación automática de la API. Sin embargo, para estas respuestas adicionales, debes devolver directamente un objeto `Response` (como `JSONResponse`) con el código de estado y contenido adecuados.

**Ejemplo básico:**

```python
from fastapi import FastAPI
from fastapi.responses import JSONResponse
from pydantic import BaseModel

class Item(BaseModel):
    id: str
    value: str

class Message(BaseModel):
    message: str

app = FastAPI()

@app.get("/items/{item_id}", response_model=Item, responses={404: {"model": Message}})
async def read_item(item_id: str):
    if item_id == "foo":
        return {"id": "foo", "value": "there goes my hero"}
    return JSONResponse(status_code=404, content={"message": "Item not found"})
```

(Descripción: Aquí se declara una respuesta adicional con código de estado `404` y un modelo Pydantic `Message`. Si el ítem no se encuentra, se devuelve un `JSONResponse` con el mensaje de error).

---

## B - Respuesta adicional con `model`

**Definición:**  
Puedes usar el parámetro `responses` en el decorador de la operación de ruta para declarar respuestas adicionales. Cada respuesta se define con un código de estado (como `200` o `404`) y un diccionario que contiene información como el modelo Pydantic (`model`) que se usará para generar el esquema JSON en OpenAPI.

**Ejemplo:**

```python
@app.get("/items/{item_id}", response_model=Item, responses={404: {"model": Message}})
async def read_item(item_id: str):
    if item_id == "foo":
        return {"id": "foo", "value": "there goes my hero"}
    return JSONResponse(status_code=404, content={"message": "Item not found"})
```

(Descripción: En este ejemplo, se declara una respuesta `404` que usa el modelo `Message`. FastAPI incluirá esta información en la documentación OpenAPI).

---

## C - Tipos de medios adicionales para la respuesta principal

**Definición:**  
Puedes usar el parámetro `responses` para agregar diferentes tipos de medios (media types) para la misma respuesta principal. Por ejemplo, puedes declarar que una operación de ruta puede devolver un objeto JSON (`application/json`) o una imagen PNG (`image/png`).

**Ejemplo:**

```python
from fastapi.responses import FileResponse

@app.get(
    "/items/{item_id}",
    response_model=Item,
    responses={
        200: {
            "content": {"image/png": {}},
            "description": "Return the JSON item or an image.",
        }
    },
)
async def read_item(item_id: str, img: Union[bool, None] = None):
    if img:
        return FileResponse("image.png", media_type="image/png")
    else:
        return {"id": "foo", "value": "there goes my hero"}
```

(Descripción: Aquí se declara que la ruta puede devolver un JSON o una imagen PNG, dependiendo del parámetro `img`).

---

## D - Combinar información de respuestas

**Definición:**  
Puedes combinar información de respuestas de múltiples lugares, como `response_model`, `status_code` y el parámetro `responses`. FastAPI combinará esta información en la documentación OpenAPI.

**Ejemplo:**

```python
@app.get(
    "/items/{item_id}",
    response_model=Item,
    responses={
        404: {"model": Message, "description": "The item was not found"},
        200: {
            "description": "Item requested by ID",
            "content": {
                "application/json": {
                    "example": {"id": "bar", "value": "The bar tenders"}
                }
            },
        },
    },
)
async def read_item(item_id: str):
    if item_id == "foo":
        return {"id": "foo", "value": "there goes my hero"}
    else:
        return JSONResponse(status_code=404, content={"message": "Item not found"})
```

(Descripción: En este ejemplo, se combina un `response_model` con respuestas personalizadas para los códigos `200` y `404`, incluyendo un ejemplo de respuesta para el código `200`).

---

## E - Combinar respuestas predefinidas y personalizadas

**Definición:**  
Puedes reutilizar respuestas predefinidas en múltiples operaciones de ruta y combinarlas con respuestas personalizadas específicas para cada ruta. Esto se hace usando la técnica de "desempaquetado" de diccionarios en Python (`**dict`).

**Ejemplo:**

```python
responses = {
    404: {"description": "Item not found"},
    302: {"description": "The item was moved"},
    403: {"description": "Not enough privileges"},
}

@app.get(
    "/items/{item_id}",
    response_model=Item,
    responses={**responses, 200: {"content": {"image/png": {}}}},
)
async def read_item(item_id: str, img: Union[bool, None] = None):
    if img:
        return FileResponse("image.png", media_type="image/png")
    else:
        return {"id": "foo", "value": "there goes my hero"}
```

(Descripción: Aquí se reutilizan respuestas predefinidas (`responses`) y se combinan con una respuesta personalizada para el código `200`).

---

## F - Más información sobre respuestas en OpenAPI

**Definición:**  
Para conocer todos los detalles sobre lo que puedes incluir en las respuestas, puedes consultar la especificación de OpenAPI. Esto incluye objetos como `description`, `headers`, `content` (donde se declaran los tipos de medios y esquemas JSON), y `links`.

**Enlaces útiles:**

- [OpenAPI Responses Object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.1.0.md#responses-object)
- [OpenAPI Response Object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.1.0.md#response-object)
