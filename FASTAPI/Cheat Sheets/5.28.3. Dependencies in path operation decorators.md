## A - Dependencias en decoradores de operaciones de ruta

**Definición:**  
En algunos casos, no necesitas el valor de retorno de una dependencia dentro de tu función de operación de ruta. O la dependencia no retorna ningún valor, pero aún necesitas que se ejecute. Para estos casos, puedes agregar una lista de dependencias al decorador de la operación de ruta en lugar de declarar un parámetro con `Depends`.

**Ejemplo:**

```python
from fastapi import Depends, FastAPI, Header, HTTPException

app = FastAPI()

async def verify_token(x_token: str = Header()):
    if x_token != "fake-super-secret-token":
        raise HTTPException(status_code=400, detail="X-Token header invalid")

async def verify_key(x_key: str = Header()):
    if x_key != "fake-super-secret-key":
        raise HTTPException(status_code=400, detail="X-Key header invalid")
    return x_key

@app.get("/items/", dependencies=[Depends(verify_token), Depends(verify_key)])
async def read_items():
    return [{"item": "Foo"}, {"item": "Bar"}]
```

**Descripción del ejemplo:**

- `verify_token` y `verify_key` son dependencias que se ejecutan antes de que se llame a `read_items`.
- Aunque `verify_key` retorna un valor, este no se pasa a `read_items`.
- Si alguna de las dependencias falla (por ejemplo, si el token no es válido), se lanza una excepción y `read_items` no se ejecuta.

---

## B - Uso de `dependencies` en el decorador de la operación de ruta

**Definición:**  
El decorador de la operación de ruta (`@app.get`, `@app.post`, etc.) acepta un parámetro opcional llamado `dependencies`, que es una lista de dependencias (`Depends`). Estas dependencias se ejecutan antes de la función de la operación de ruta, pero sus valores de retorno no se pasan a la función.

**Ejemplo:**

```python
from fastapi import Depends, FastAPI, HTTPException, Header

app = FastAPI()

async def check_header(x_custom: str = Header()):
    if x_custom != "expected-value":
        raise HTTPException(status_code=400, detail="Invalid header")

@app.get("/data/", dependencies=[Depends(check_header)])
async def get_data():
    return {"data": "Some important data"}
```

**Descripción del ejemplo:**

- `check_header` es una dependencia que verifica un encabezado personalizado.
- Si el encabezado no es válido, se lanza una excepción y `get_data` no se ejecuta.
- El valor de retorno de `check_header` no se pasa a `get_data`.

---

## C - Dependencias que lanzan excepciones

**Definición:**  
Las dependencias pueden lanzar excepciones, como `HTTPException`, para detener la ejecución de la operación de ruta si no se cumplen ciertas condiciones.

**Ejemplo:**

```python
from fastapi import Depends, FastAPI, HTTPException, Header

app = FastAPI()

async def verify_token(x_token: str = Header()):
    if x_token != "fake-super-secret-token":
        raise HTTPException(status_code=400, detail="Invalid token")

@app.get("/secure/", dependencies=[Depends(verify_token)])
async def secure_endpoint():
    return {"message": "You are authenticated"}
```

**Descripción del ejemplo:**

- `verify_token` verifica un token en el encabezado.
- Si el token no es válido, se lanza una excepción y `secure_endpoint` no se ejecuta.

---

## D - Dependencias que retornan valores

**Definición:**  
Las dependencias pueden retornar valores, pero si se usan en el parámetro `dependencies` del decorador, estos valores no se pasan a la función de la operación de ruta. Sin embargo, la dependencia se ejecuta.

**Ejemplo:**

```python
from fastapi import Depends, FastAPI, Header

app = FastAPI()

async def get_api_key(x_key: str = Header()):
    return x_key

@app.get("/protected/", dependencies=[Depends(get_api_key)])
async def protected_endpoint():
    return {"message": "This endpoint is protected"}
```

**Descripción del ejemplo:**

- `get_api_key` retorna el valor de un encabezado, pero este valor no se pasa a `protected_endpoint`.
- La dependencia se ejecuta antes de la función de la operación de ruta.

---

## E - Dependencias para un grupo de operaciones de ruta

**Definición:**  
Puedes declarar dependencias que se apliquen a un grupo de operaciones de ruta. Esto es útil cuando tienes múltiples rutas que comparten las mismas dependencias.

**Ejemplo:**

```python
from fastapi import Depends, FastAPI, HTTPException, Header, APIRouter

app = FastAPI()
router = APIRouter(dependencies=[Depends(verify_token)])

async def verify_token(x_token: str = Header()):
    if x_token != "fake-super-secret-token":
        raise HTTPException(status_code=400, detail="Invalid token")

@router.get("/items/")
async def read_items():
    return [{"item": "Foo"}, {"item": "Bar"}]

@router.get("/users/")
async def read_users():
    return [{"user": "John"}, {"user": "Jane"}]

app.include_router(router)
```

**Descripción del ejemplo:**

- `verify_token` es una dependencia que se aplica a todas las rutas dentro del `router`.
- Tanto `read_items` como `read_users` requieren que `verify_token` se ejecute antes de que se llamen.

---

## F - Dependencias globales

**Definición:**  
Puedes agregar dependencias que se apliquen a todas las operaciones de ruta en una aplicación FastAPI. Estas dependencias se ejecutan antes de cualquier operación de ruta.

**Ejemplo:**

```python
from fastapi import Depends, FastAPI, HTTPException, Header

app = FastAPI(dependencies=[Depends(verify_token)])

async def verify_token(x_token: str = Header()):
    if x_token != "fake-super-secret-token":
        raise HTTPException(status_code=400, detail="Invalid token")

@app.get("/items/")
async def read_items():
    return [{"item": "Foo"}, {"item": "Bar"}]

@app.get("/users/")
async def read_users():
    return [{"user": "John"}, {"user": "Jane"}]
```

**Descripción del ejemplo:**

- `verify_token` es una dependencia global que se aplica a todas las rutas en la aplicación.
- Tanto `read_items` como `read_users` requieren que `verify_token` se ejecute antes de que se llamen.
