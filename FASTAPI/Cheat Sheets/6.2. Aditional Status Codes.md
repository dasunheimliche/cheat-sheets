## A - Additional Status Codes (Retornando Response directamente)

**Definición:**

FastAPI normalmente maneja las respuestas con `JSONResponse` y códigos de estado predeterminados o definidos en la operación de ruta. Para retornar códigos de estado adicionales _directamente_ (sin serialización automática con modelos), se debe retornar un objeto `Response` (como `JSONResponse`) configurando el `status_code` deseado.

**Ejemplo:**

```Python

    from typing import Annotated

    from fastapi import Body, FastAPI, status
    from fastapi.responses import JSONResponse

    app = FastAPI()

    items = {}

    @app.put("/items/{item_id}")
    async def upsert_item(
        item_id: str,
        name: Annotated[str | None, Body()] = None,
        size: Annotated[int | None, Body()] = None,
    ):
        if item_id in items:
            item = items[item_id]
            item["name"] = name
            item["size"] = size
            return item #Retorna 200 OK por defecto
        else:
            item = {"name": name, "size": size}
            items[item_id] = item
            return JSONResponse(status_code=status.HTTP_201_CREATED, content=item) #Retorna 201 Created
```

(Si el `item_id` ya existe, se actualiza y se retorna el item con un código 200 OK por defecto. Si no existe, se crea el item y se retorna un `JSONResponse` con código 201 Created.)

**Advertencia Importante:** Cuando se retorna un `Response` directamente, FastAPI _no_ realiza serialización con modelos Pydantic. Se debe asegurar que los datos en el `content` sean JSON válido.

## B - OpenAPI y API Docs (con Retorno Directo de Response)

**Definición:**

Cuando se retornan códigos de estado adicionales _directamente_ con un objeto `Response`, FastAPI no los incluye automáticamente en el esquema OpenAPI (y por lo tanto, en la documentación interactiva). Esto se debe a que FastAPI no puede inferir dinámicamente las posibles respuestas.

**Ejemplo:**

En el ejemplo anterior, el código 201 Created _no_ aparecerá automáticamente en la documentación de la API.

**Solución:**

Para documentar estos códigos de estado adicionales, se debe usar la funcionalidad de "Additional Responses" que se explicó en la respuesta anterior. Esto permite especificar explícitamente las respuestas adicionales en la definición de la ruta.

**Relación con "Additional Responses" (de la respuesta anterior):**

Este concepto explica la _limitación_ de la generación automática de OpenAPI cuando se usan `Response` directos. "Additional Responses" es la _solución_ para superar esta limitación y documentar correctamente todas las posibles respuestas. En resumen, si se retornan `Response` directamente, se _debe_ usar "Additional Responses" para una documentación completa.
