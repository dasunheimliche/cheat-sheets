## A - Manejo de archivos y campos de formulario en FastAPI

**Definición:**  
FastAPI permite manejar tanto archivos como campos de formulario en la misma solicitud usando `File` y `Form`. Los archivos y los datos del formulario se envían como "datos de formulario" (`multipart/form-data`), y FastAPI se encarga de extraerlos automáticamente.

**Requisito previo:**  
Para manejar archivos y formularios, debes instalar `python-multipart` en tu entorno virtual:

```bash
pip install python-multipart
```

---

## B - Importar `File` y `Form`

**Definición:**  
Para trabajar con archivos y campos de formulario en FastAPI, debes importar `File` y `Form` desde `fastapi`. `File` se usa para manejar archivos, mientras que `Form` se usa para extraer datos de formulario.

Ejemplo:

```python
from fastapi import FastAPI, File, Form, UploadFile

app = FastAPI()

@app.post("/files/")
async def create_file(
    file: bytes = File(),
    fileb: UploadFile = File(),
    token: str = Form()
):
    return {
        "file_size": len(file),
        "token": token,
        "fileb_content_type": fileb.content_type,
    }
```

**Descripción:**

- `File()` se usa para recibir archivos como `bytes` o `UploadFile`.
- `Form()` se usa para extraer campos de formulario, como `token` en este ejemplo.

---

## C - Uso de `File` y `Form` juntos

**Definición:**  
Puedes combinar `File` y `Form` en la misma operación de ruta para manejar archivos y campos de formulario simultáneamente. FastAPI automáticamente separa los archivos de los campos de formulario en la solicitud.

Ejemplo:

```python
@app.post("/files/")
async def create_file(
    file: bytes = File(),
    fileb: UploadFile = File(),
    token: str = Form()
):
    return {
        "file_size": len(file),
        "token": token,
        "fileb_content_type": fileb.content_type,
    }
```

**Descripción:**

- `file: bytes = File()` recibe un archivo como `bytes`.
- `fileb: UploadFile = File()` recibe un archivo como `UploadFile`.
- `token: str = Form()` extrae un campo de formulario llamado `token`.

---

## D - Limitaciones de `multipart/form-data`

**Definición:**  
Cuando usas `File` y `Form`, el cuerpo de la solicitud se codifica como `multipart/form-data`. Esto significa que **no puedes** usar `Body` (para JSON) en la misma operación de ruta, ya que el cuerpo de la solicitud solo puede estar codificado de una manera.

**Advertencia:**  
No declares campos `Body` en una operación de ruta que ya usa `File` o `Form`, ya que generará un error.

---

## E - Versiones con `Annotated`

**Definición:**  
FastAPI recomienda usar `Annotated` para declarar parámetros de `File` y `Form`, ya que proporciona una sintaxis más clara y moderna.

Ejemplo con `Annotated`:

```python
from typing import Annotated
from fastapi import FastAPI, File, Form, UploadFile

app = FastAPI()

@app.post("/files/")
async def create_file(
    file: Annotated[bytes, File()],
    fileb: Annotated[UploadFile, File()],
    token: Annotated[str, Form()],
):
    return {
        "file_size": len(file),
        "token": token,
        "fileb_content_type": fileb.content_type,
    }
```

**Descripción:**

- `Annotated[bytes, File()]` declara un archivo como `bytes`.
- `Annotated[UploadFile, File()]` declara un archivo como `UploadFile`.
- `Annotated[str, Form()]` declara un campo de formulario como `str`.

---

## F - Manejo de múltiples archivos y campos de formulario

**Definición:**  
Puedes manejar múltiples archivos y campos de formulario en la misma solicitud. Simplemente declara los parámetros necesarios con `File` y `Form`.

Ejemplo:

```python
@app.post("/files/")
async def create_file(
    file1: bytes = File(),
    file2: UploadFile = File(),
    token: str = Form(),
    username: str = Form()
):
    return {
        "file1_size": len(file1),
        "file2_filename": file2.filename,
        "token": token,
        "username": username,
    }
```

**Descripción:**

- `file1: bytes = File()` y `file2: UploadFile = File()` manejan dos archivos diferentes.
- `token: str = Form()` y `username: str = Form()` extraen dos campos de formulario.
