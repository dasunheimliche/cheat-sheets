## A - Codificador compatible con JSON (`jsonable_encoder`)

**Definición:**  
FastAPI proporciona una función llamada `jsonable_encoder` que convierte objetos de Python (como modelos Pydantic) en estructuras compatibles con JSON, como diccionarios (`dict`) o listas (`list`). Esto es útil cuando necesitas almacenar datos en una base de datos o enviarlos a un sistema que solo acepta JSON.

**Casos de uso comunes:**

- Convertir modelos Pydantic en diccionarios.
- Convertir objetos `datetime` en cadenas en formato ISO.
- Preparar datos para ser serializados en JSON.

---

## B - Uso de `jsonable_encoder`

**Definición:**  
La función `jsonable_encoder` toma un objeto (por ejemplo, un modelo Pydantic) y devuelve una versión compatible con JSON. Esto incluye la conversión de tipos no compatibles con JSON (como `datetime`) a tipos compatibles (como `str`).

Ejemplo:

```python
from datetime import datetime
from fastapi import FastAPI
from fastapi.encoders import jsonable_encoder
from pydantic import BaseModel

fake_db = {}

class Item(BaseModel):
    title: str
    timestamp: datetime
    description: str | None = None

app = FastAPI()

@app.put("/items/{id}")
def update_item(id: str, item: Item):
    json_compatible_item_data = jsonable_encoder(item)
    fake_db[id] = json_compatible_item_data
    return {"message": "Item updated", "id": id, "data": json_compatible_item_data}
```

**Descripción:**

- `jsonable_encoder(item)` convierte el modelo `Item` en un diccionario compatible con JSON.
- El campo `timestamp` (de tipo `datetime`) se convierte automáticamente en una cadena en formato ISO (por ejemplo, `"2023-10-01T12:34:56"`).
- El resultado se almacena en `fake_db`, que simula una base de datos que solo acepta JSON.

---

## C - Detalles técnicos de `jsonable_encoder`

**Definición:**  
`jsonable_encoder` no devuelve una cadena JSON directamente, sino una estructura de datos de Python (como un diccionario) cuyos valores son compatibles con JSON. Esto permite usar `json.dumps()` para serializar los datos si es necesario.

Ejemplo de uso con `json.dumps()`:

```python
import json
from fastapi.encoders import jsonable_encoder

data = jsonable_encoder(item)
json_string = json.dumps(data)
```

**Descripción:**

- `jsonable_encoder` devuelve una estructura de datos que puede ser serializada directamente con `json.dumps()`.
- Esto es útil si necesitas enviar los datos a un sistema externo que espera una cadena JSON.

---

## D - Uso interno de `jsonable_encoder` en FastAPI

**Definición:**  
FastAPI utiliza internamente `jsonable_encoder` para convertir datos antes de enviarlos en respuestas HTTP. Sin embargo, también puedes usarla directamente en tu código para preparar datos antes de almacenarlos o procesarlos.

**Ejemplo de uso interno:**  
Cuando FastAPI devuelve un modelo Pydantic en una respuesta, automáticamente lo convierte en JSON usando `jsonable_encoder`.

---

## E - Resumen de `jsonable_encoder`

**Definición:**  
`jsonable_encoder` es una herramienta poderosa para convertir objetos de Python en estructuras compatibles con JSON. Es especialmente útil cuando trabajas con bases de datos o sistemas que requieren datos en formato JSON.

**Casos comunes:**

- Convertir modelos Pydantic en diccionarios.
- Convertir objetos `datetime` en cadenas.
- Preparar datos para ser serializados en JSON.

**Ejemplo completo:**

```python
from datetime import datetime
from fastapi import FastAPI
from fastapi.encoders import jsonable_encoder
from pydantic import BaseModel

app = FastAPI()

class Item(BaseModel):
    title: str
    timestamp: datetime
    description: str | None = None

@app.post("/items/")
def create_item(item: Item):
    # Convertir el modelo Pydantic en un diccionario compatible con JSON
    json_data = jsonable_encoder(item)
    return {"message": "Item created", "data": json_data}
```

**Descripción:**

- En este ejemplo, `jsonable_encoder` convierte el modelo `Item` en un diccionario compatible con JSON.
- El campo `timestamp` se convierte automáticamente en una cadena en formato ISO.
