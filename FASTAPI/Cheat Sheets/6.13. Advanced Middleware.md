## A - Middlewares ASGI

**Definición:** FastAPI permite usar cualquier middleware que siga la especificación ASGI, ya que está construido sobre Starlette y la implementa.

**Ejemplo:**

```Python
# Ejemplo hipotético de un middleware ASGI
class MyCustomMiddleware:
    def __init__(self, app):
        self.app = app

    async def __call__(self, scope, receive, send):
        # Lógica del middleware
        await self.app(scope, receive, send)

from fastapi import FastAPI

app = FastAPI()

# app.add_middleware(MyCustomMiddleware) # Ejemplo de uso
```

(Este ejemplo muestra la estructura básica de un middleware ASGI y cómo se podría agregar a FastAPI.)

## B - Clases Middleware ASGI

**Definición:** Los middlewares ASGI son generalmente clases que reciben una aplicación ASGI como primer argumento en su constructor (**init**).

**Ejemplo:**

```Python
# Ejemplo de un middleware ASGI
class MyCustomMiddleware:
    def __init__(self, app):
        self.app = app # Recibe la app ASGI

    async def __call__(self, scope, receive, send):
        # Lógica del middleware
        await self.app(scope, receive, send)
```

(Este ejemplo muestra cómo un middleware ASGI recibe la aplicación ASGI en su constructor.)

## C - app.add_middleware()

**Definición:** FastAPI proporciona app.add_middleware() para agregar middlewares, asegurando el manejo correcto de errores y excepciones.

**Ejemplo:**

```Python
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware

app = FastAPI()

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

(Este ejemplo muestra cómo se agrega el middleware CORS usando app.add_middleware().)

## D - Middlewares Integrados

**Definición:** FastAPI incluye varios middlewares para casos de uso comunes, facilitando su implementación.

**Ejemplo:**

(Los siguientes ejemplos muestran el uso de middlewares integrados.)

## E - HTTPSRedirectMiddleware

**Definición:** Fuerza que todas las solicitudes entrantes sean HTTPS o WSS, redirigiendo las solicitudes HTTP o WS a los esquemas seguros.

**Ejemplo:**

```Python
from fastapi import FastAPI
from fastapi.middleware.httpsredirect import HTTPSRedirectMiddleware

app = FastAPI()

app.add_middleware(HTTPSRedirectMiddleware)

@app.get("/")
async def main():
    return {"message": "Hello World"}
```

(Este ejemplo muestra cómo agregar el middleware HTTPSRedirectMiddleware.)

## F - TrustedHostMiddleware

**Definición:** Asegura que todas las solicitudes entrantes tengan un encabezado Host correctamente configurado, protegiendo contra ataques de encabezado HTTP Host.

**Ejemplo:**

```Python
from fastapi import FastAPI
from fastapi.middleware.trustedhost import TrustedHostMiddleware

app = FastAPI()

app.add_middleware(
    TrustedHostMiddleware, allowed_hosts=["example.com", "*.example.com"]
)

@app.get("/")
async def main():
    return {"message": "Hello World"}
```

(Este ejemplo muestra cómo agregar el middleware TrustedHostMiddleware y configurar los hosts permitidos.)

## G - GZipMiddleware

**Definición:** Maneja respuestas GZip para cualquier solicitud que incluya "gzip" en el encabezado Accept-Encoding.

**Ejemplo:**

```Python
from fastapi import FastAPI
from fastapi.middleware.gzip import GZipMiddleware

app = FastAPI()

app.add_middleware(GZipMiddleware, minimum_size=1000, compresslevel=5)

@app.get("/")
async def main():
    return "somebigcontent"
```

(Este ejemplo muestra cómo agregar el middleware GZipMiddleware y configurar el tamaño mínimo y el nivel de compresión.)

## H - Otros Middlewares

**Definición:** Existen muchos otros middlewares ASGI disponibles, como ProxyHeadersMiddleware de Uvicorn o middlewares para MessagePack.

**Ejemplo:**

(No hay un ejemplo específico, pero se refiere a la existencia de otros middlewares que se pueden usar con FastAPI.)
