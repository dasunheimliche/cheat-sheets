## A - JWT (JSON Web Tokens)

**Definición:** JWT es un estándar para codificar un objeto JSON en una cadena larga y densa sin espacios. No está cifrado, pero está firmado, lo que permite verificar su autenticidad.

**Ejemplo:**

```python
import jwt

SECRET_KEY = "your_secret_key"
ALGORITHM = "HS256"

def create_jwt(data: dict):
    return jwt.encode(data, SECRET_KEY, algorithm=ALGORITHM)

token = create_jwt({"sub": "user_id"})
```

En este ejemplo, se crea un token JWT con un identificador de usuario.

## B - Hashing de Contraseña

**Definición:** El hashing de contraseña convierte una contraseña en una secuencia de bytes que parece un galimatías, lo que hace que sea difícil revertirla a su forma original.

**Ejemplo:**

```python
from passlib.context import CryptContext

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

def hash_password(password: str):
    return pwd_context.hash(password)

hashed_password = hash_password("mysecretpassword")
```

En este ejemplo, hash_password toma una contraseña y devuelve una versión "hash" de la misma.

## C - Verificación de Contraseña

**Definición:** La verificación de contraseña compara una contraseña en texto plano con su versión hash para verificar si coinciden.

**Ejemplo:**

```python
def verify_password(plain_password: str, hashed_password: str):
    return pwd_context.verify(plain_password, hashed_password)

is_valid = verify_password("mysecretpassword", hashed_password)
```

En este ejemplo, verify_password verifica si la contraseña proporcionada coincide con la versión hash almacenada.

## D - OAuth2PasswordBearer

**Definición:** OAuth2PasswordBearer es una clase en FastAPI que se utiliza para implementar la autenticación mediante OAuth2 con el flujo de contraseña y un token Bearer.

**Ejemplo:**

```python
from fastapi import Depends, FastAPI
from fastapi.security import OAuth2PasswordBearer

app = FastAPI()
oauth2_scheme = OAuth2PasswordBearer(tokenUrl="token")

@app.get("/items/")
async def read_items(token: str = Depends(oauth2_scheme)):
    return {"token": token}
```

En este ejemplo, OAuth2PasswordBearer se utiliza para declarar que la URL /token será la que el cliente usará para enviar el nombre de usuario y la contraseña para obtener un token.

## E - Obtener Usuario Actual

**Definición:** La función get_current_user se utiliza para obtener el usuario actual a partir de un token proporcionado.

**Ejemplo:**

```python
from fastapi import Depends, HTTPException, status

async def get_current_user(token: str = Depends(oauth2_scheme)):
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        return {"username": username}
    except jwt.InvalidTokenError:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Could not validate credentials",
            headers={"WWW-Authenticate": "Bearer"},
        )
```

En este ejemplo, get_current_user decodifica el token y obtiene el nombre de usuario.
