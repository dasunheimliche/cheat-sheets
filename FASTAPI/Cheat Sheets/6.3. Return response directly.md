## A - Devolver una respuesta directamente

**Definición:**  
En FastAPI, normalmente puedes devolver cualquier dato desde una operación de ruta: un `dict`, una `list`, un modelo Pydantic, un modelo de base de datos, etc. Por defecto, FastAPI convierte automáticamente ese valor de retorno a JSON usando el `jsonable_encoder`. Sin embargo, también puedes devolver una `Response` directamente, como `JSONResponse`, lo que te permite personalizar encabezados, cookies, o incluso devolver tipos de contenido no JSON.

**Ejemplo:**

```python
from fastapi import FastAPI
from fastapi.responses import JSONResponse

app = FastAPI()

@app.get("/custom-json/")
async def custom_json():
    return JSONResponse(content={"message": "Hello, world!"}, status_code=200)
```

**Descripción del ejemplo:**  
Aquí se devuelve un `JSONResponse` directamente con un mensaje personalizado y un código de estado 200.

---

## B - Usar `jsonable_encoder` en una `Response`

**Definición:**  
Cuando devuelves una `Response` directamente, FastAPI no realiza ninguna conversión automática de datos. Si necesitas incluir un modelo Pydantic en una `JSONResponse`, primero debes convertirlo a un `dict` usando `jsonable_encoder`. Esto asegura que los tipos de datos como `datetime` o `UUID` sean compatibles con JSON.

**Ejemplo:**

```python
from datetime import datetime
from fastapi import FastAPI
from fastapi.encoders import jsonable_encoder
from fastapi.responses import JSONResponse
from pydantic import BaseModel

app = FastAPI()

class Item(BaseModel):
    title: str
    timestamp: datetime
    description: str | None = None

@app.put("/items/{id}")
def update_item(id: str, item: Item):
    json_compatible_item_data = jsonable_encoder(item)
    return JSONResponse(content=json_compatible_item_data)
```

**Descripción del ejemplo:**  
Aquí se convierte un modelo Pydantic (`Item`) a un `dict` usando `jsonable_encoder` antes de devolverlo en un `JSONResponse`.

---

## C - Devolver una `Response` personalizada

**Definición:**  
Puedes devolver cualquier tipo de `Response`, no solo `JSONResponse`. Esto es útil para devolver tipos de contenido personalizados, como XML. Simplemente crea una `Response` con el contenido y el tipo de medio (`media_type`) adecuados.

**Ejemplo:**

```python
from fastapi import FastAPI, Response

app = FastAPI()

@app.get("/legacy/")
def get_legacy_data():
    data = """<?xml version="1.0"?>
    <shampoo>
    <Header>
        Apply shampoo here.
    </Header>
    <Body>
        You'll have to use soap here.
    </Body>
    </shampoo>
    """
    return Response(content=data, media_type="application/xml")
```

**Descripción del ejemplo:**  
Este código devuelve una respuesta XML personalizada usando `Response` con el tipo de medio `application/xml`.

---

## D - Limitaciones de devolver una `Response` directamente

**Definición:**  
Cuando devuelves una `Response` directamente, FastAPI no valida, convierte ni documenta automáticamente los datos. Esto significa que no aparecerá en la documentación OpenAPI generada. Sin embargo, puedes documentar manualmente estas respuestas usando la funcionalidad de **Respuestas Adicionales** de FastAPI.

---

## E - Notas adicionales

**Definición:**

- FastAPI proporciona `JSONResponse` y otras respuestas como una conveniencia, pero en realidad vienen de Starlette, el framework subyacente.
- Si necesitas devolver respuestas personalizadas pero aún deseas aprovechar la validación y documentación automática, puedes combinar estas técnicas con **Respuestas Adicionales**.
