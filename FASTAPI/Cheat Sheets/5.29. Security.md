## A - OAuth2

**Definición:**  
OAuth2 es una especificación que define varias formas de manejar la autenticación y autorización. Es ampliamente utilizado en sistemas de "inicio de sesión con Facebook, Google, etc." y cubre casos de uso complejos. No especifica cómo cifrar la comunicación, por lo que se espera que uses HTTPS.

**Ejemplo:**

```python
from fastapi import FastAPI, Depends
from fastapi.security import OAuth2PasswordBearer

app = FastAPI()

oauth2_scheme = OAuth2PasswordBearer(tokenUrl="token")

@app.get("/items/")
async def read_items(token: str = Depends(oauth2_scheme)):
    return {"token": token}
```

**Descripción del ejemplo:**  
Este código muestra cómo usar OAuth2 en FastAPI. `OAuth2PasswordBearer` es una herramienta que ayuda a manejar la autenticación basada en tokens. El token se obtiene de la URL especificada en `tokenUrl`.

---

## B - OpenID Connect

**Definición:**  
OpenID Connect es una extensión de OAuth2 que aclara aspectos ambiguos de OAuth2 para mejorar la interoperabilidad. Es utilizado por servicios como Google Login, pero no todos los servicios lo soportan (por ejemplo, Facebook tiene su propia versión de OAuth2).

**Ejemplo:**

```python
from fastapi import FastAPI, Depends
from fastapi.security import OpenIdConnect

app = FastAPI()

oid = OpenIdConnect(openIdConnectUrl="https://example.com/.well-known/openid-configuration")

@app.get("/items/")
async def read_items(token: str = Depends(oid)):
    return {"token": token}
```

**Descripción del ejemplo:**  
Este código muestra cómo integrar OpenID Connect en FastAPI. `OpenIdConnect` se configura con una URL que proporciona los detalles de autenticación automáticamente.

---

## C - OpenAPI

**Definición:**  
OpenAPI (antes conocido como Swagger) es una especificación para construir APIs. FastAPI se basa en OpenAPI, lo que permite generar documentación interactiva y código automáticamente. OpenAPI define varios esquemas de seguridad, como `apiKey`, `http`, `oauth2`, y `openIdConnect`.

**Ejemplo:**

```python
from fastapi import FastAPI
from fastapi.security import APIKeyHeader

app = FastAPI()

api_key_header = APIKeyHeader(name="X-API-Key")

@app.get("/items/")
async def read_items(api_key: str = Depends(api_key_header)):
    return {"api_key": api_key}
```

**Descripción del ejemplo:**  
Este código muestra cómo usar un esquema de seguridad `apiKey` en FastAPI. El API key se obtiene del encabezado `X-API-Key`.

---

## D - Esquemas de seguridad en OpenAPI

**Definición:**  
OpenAPI define varios esquemas de seguridad:

1.  **apiKey**: Una clave específica de la aplicación que puede venir de un parámetro de consulta, un encabezado o una cookie.
2.  **http**: Sistemas de autenticación HTTP estándar, como `bearer` (usado en OAuth2), Basic y Digest.
3.  **oauth2**: Define varios "flujos" de OAuth2, como `implicit`, `clientCredentials`, `authorizationCode`, y `password`.
4.  **openIdConnect**: Permite descubrir automáticamente datos de autenticación OAuth2.

**Ejemplo:**

```python
from fastapi import FastAPI, Depends
from fastapi.security import HTTPBearer

app = FastAPI()

bearer = HTTPBearer()

@app.get("/items/")
async def read_items(token: str = Depends(bearer)):
    return {"token": token}
```

**Descripción del ejemplo:**  
Este código muestra cómo usar autenticación HTTP Bearer en FastAPI. El token se obtiene del encabezado `Authorization`.

---

## E - Utilidades de FastAPI para seguridad

**Definición:**  
FastAPI proporciona herramientas en el módulo `fastapi.security` para simplificar el uso de mecanismos de seguridad como OAuth2, OpenID Connect, y otros. Estas herramientas se integran automáticamente con la documentación interactiva.

**Ejemplo:**

```python
from fastapi import FastAPI, Depends
from fastapi.security import OAuth2PasswordBearer

app = FastAPI()

oauth2_scheme = OAuth2PasswordBearer(tokenUrl="token")

@app.get("/items/")
async def read_items(token: str = Depends(oauth2_scheme)):
    return {"token": token}
```

**Descripción del ejemplo:**  
Este código muestra cómo usar `OAuth2PasswordBearer` para manejar la autenticación con OAuth2 en FastAPI. La herramienta simplifica la obtención del token.

---

## F - HTTPS y seguridad

**Definición:**  
OAuth2 no especifica cómo cifrar la comunicación, por lo que es esencial usar HTTPS para proteger los datos. FastAPI recomienda configurar HTTPS usando herramientas como Traefik y Let's Encrypt.

**Ejemplo:**

```bash
# Configuración básica de Traefik con Let's Encrypt para HTTPS
traefik --api --certificatesresolvers.myresolver.acme.email=you@example.com --entrypoints.web.address=:80 --entrypoints.websecure.address=:443
```

**Descripción del ejemplo:**  
Este comando configura Traefik para usar Let's Encrypt y servir tu aplicación con HTTPS.
