## A - WSGI (Web Server Gateway Interface)

**Definición:**  
WSGI es una especificación que permite a las aplicaciones web escritas en Python comunicarse con servidores web. Frameworks como Flask y Django siguen esta especificación. FastAPI, aunque es ASGI (Asynchronous Server Gateway Interface), puede integrar aplicaciones WSGI usando un middleware.

**Ejemplo:**

```python
from fastapi import FastAPI
from fastapi.middleware.wsgi import WSGIMiddleware
from flask import Flask, request
from markupsafe import escape

flask_app = Flask(__name__)

@flask_app.route("/")
def flask_main():
    name = request.args.get("name", "World")
    return f"Hello, {escape(name)} from Flask!"

app = FastAPI()

@app.get("/v2")
def read_main():
    return {"message": "Hello World"}

app.mount("/v1", WSGIMiddleware(flask_app))
```

**Descripción del ejemplo:**  
En este ejemplo, se integra una aplicación Flask (WSGI) dentro de una aplicación FastAPI (ASGI) usando `WSGIMiddleware`. Las solicitudes bajo la ruta `/v1/` serán manejadas por Flask, mientras que las demás serán manejadas por FastAPI.

---

## B - WSGIMiddleware

**Definición:**  
`WSGIMiddleware` es un middleware que permite integrar aplicaciones WSGI (como Flask o Django) dentro de una aplicación FastAPI. Esto es útil cuando quieres combinar una aplicación ASGI con una WSGI existente.

**Ejemplo:**

```python
from fastapi.middleware.wsgi import WSGIMiddleware
from flask import Flask

flask_app = Flask(__name__)

app = FastAPI()
app.mount("/v1", WSGIMiddleware(flask_app))
```

**Descripción del ejemplo:**  
Aquí, `WSGIMiddleware` envuelve la aplicación Flask (`flask_app`) y la monta bajo la ruta `/v1` en la aplicación FastAPI. Esto permite que ambas aplicaciones coexistan y manejen solicitudes en diferentes rutas.

---

## C - Montar una aplicación WSGI bajo una ruta

**Definición:**  
Montar una aplicación WSGI bajo una ruta específica significa que todas las solicitudes que comiencen con esa ruta serán manejadas por la aplicación WSGI, mientras que el resto serán manejadas por la aplicación principal (FastAPI).

**Ejemplo:**

```python
app.mount("/v1", WSGIMiddleware(flask_app))
```

**Descripción del ejemplo:**  
En este caso, cualquier solicitud a `/v1/` o sus subrutas (como `/v1/about`) será manejada por la aplicación Flask. Las solicitudes a otras rutas (como `/v2`) serán manejadas por FastAPI.

---

## D - Verificación de la integración

**Definición:**  
Después de integrar una aplicación WSGI en FastAPI, puedes verificar que las solicitudes se manejen correctamente accediendo a las rutas correspondientes en tu navegador o herramienta de pruebas (como Postman).

**Ejemplo:**

1.  Accede a `http://localhost:8000/v1/` para ver la respuesta de Flask:

    ```plaintext
        Hello, World from Flask!
    ```

2.  Accede a `http://localhost:8000/v2` para ver la respuesta de FastAPI:

    ```json
    {
      "message": "Hello World"
    }
    ```

**Descripción del ejemplo:**  
Esto confirma que la integración funciona correctamente: Flask maneja las solicitudes bajo `/v1/` y FastAPI maneja las demás.

---

## E - Beneficios de integrar WSGI en FastAPI

**Definición:**  
Integrar una aplicación WSGI en FastAPI permite combinar lo mejor de ambos mundos: la asincronía y el rendimiento de FastAPI con la compatibilidad y funcionalidad de aplicaciones WSGI existentes (como Flask o Django).

**Ejemplo:**

```python
app.mount("/v1", WSGIMiddleware(flask_app))
```

**Descripción del ejemplo:**  
Este enfoque es útil si tienes una aplicación Flask existente y quieres migrar gradualmente a FastAPI sin reescribir todo el código. Puedes montar Flask bajo una ruta específica y seguir usando FastAPI para nuevas funcionalidades.
