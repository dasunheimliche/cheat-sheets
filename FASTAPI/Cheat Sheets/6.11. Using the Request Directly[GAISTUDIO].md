## A - Uso directo del objeto `Request`

**Definición:**  
En FastAPI, normalmente declaras los parámetros que necesitas (como parámetros de ruta, encabezados, cookies, etc.) y FastAPI se encarga de validarlos, convertirlos y documentarlos automáticamente. Sin embargo, en algunos casos, es útil acceder directamente al objeto `Request` de Starlette (el framework subyacente de FastAPI). Esto te permite obtener información detallada de la solicitud, como la dirección IP del cliente, pero sin la validación y documentación automática que FastAPI proporciona.

**Ejemplo:**

```python
from fastapi import FastAPI, Request

app = FastAPI()

@app.get("/items/{item_id}")
def read_root(item_id: str, request: Request):
    client_host = request.client.host
    return {"client_host": client_host, "item_id": item_id}
```

**Descripción del ejemplo:**  
Este código define una ruta `/items/{item_id}` que recibe un parámetro de ruta `item_id` y el objeto `Request`. Dentro de la función, se accede a la dirección IP del cliente (`client.host`) a través del objeto `Request`. El resultado devuelve tanto la dirección IP como el `item_id`.

---

## B - Detalles sobre el objeto `Request`

**Definición:**  
El objeto `Request` proviene de Starlette, el framework en el que se basa FastAPI. Cuando accedes directamente al objeto `Request`, los datos que obtengas (como el cuerpo de la solicitud) no serán validados, convertidos ni documentados automáticamente por FastAPI. Sin embargo, otros parámetros declarados normalmente (como un cuerpo de solicitud con un modelo Pydantic) seguirán siendo validados y documentados.

**Ejemplo:**

```python
from fastapi import FastAPI, Request

app = FastAPI()

@app.post("/items/")
async def create_item(request: Request):
    body = await request.body()
    return {"body_size": len(body)}
```

**Descripción del ejemplo:**  
Este código define una ruta POST `/items/` que recibe el objeto `Request` directamente. Dentro de la función, se lee el cuerpo de la solicitud (`request.body()`) y se devuelve el tamaño del cuerpo en bytes. Aquí, el cuerpo no se valida ni se convierte automáticamente.

---

## C - Documentación del objeto `Request`

**Definición:**  
El objeto `Request` tiene muchas propiedades y métodos útiles, como `client.host` para obtener la dirección IP del cliente, `headers` para acceder a los encabezados de la solicitud, y `body()` para leer el cuerpo de la solicitud. Puedes encontrar más detalles en la [documentación oficial de Starlette](https://www.starlette.io/requests/).

**Ejemplo:**

```python
from fastapi import FastAPI, Request

app = FastAPI()

@app.get("/headers/")
def read_headers(request: Request):
    user_agent = request.headers.get("user-agent")
    return {"user_agent": user_agent}
```

**Descripción del ejemplo:**  
Este código define una ruta `/headers/` que accede al encabezado `User-Agent` de la solicitud a través del objeto `Request`. El valor del encabezado se devuelve en la respuesta.

---

## D - Importar `Request` desde Starlette

**Definición:**  
Aunque FastAPI proporciona el objeto `Request` directamente por conveniencia, también puedes importarlo directamente desde Starlette. Esto es útil si prefieres ser explícito sobre la dependencia de Starlette.

**Ejemplo:**

```python
from fastapi import FastAPI
from starlette.requests import Request

app = FastAPI()

@app.get("/items/{item_id}")
def read_item(item_id: str, request: Request):
    return {"item_id": item_id, "client_host": request.client.host}
```

**Descripción del ejemplo:**  
Este código es similar al primer ejemplo, pero aquí se importa `Request` directamente desde `starlette.requests`. El comportamiento es el mismo, ya que FastAPI utiliza Starlette internamente.
