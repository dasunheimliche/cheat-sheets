## A - Generación de Clientes (SDKs) desde OpenAPI

**Definición:**  
FastAPI, al estar basado en la especificación OpenAPI, permite generar automáticamente clientes (también llamados SDKs) para tu API en varios lenguajes de programación. Esto es útil para integrar tu API en aplicaciones frontend o backend de manera eficiente.

**Ejemplo:**

```python
from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI()

class Item(BaseModel):
    name: str
    price: float

@app.post("/items/")
async def create_item(item: Item):
    return {"message": "Item received"}
```

**Descripción del ejemplo:**  
Este código define una API simple con FastAPI. Gracias a OpenAPI, puedes generar un cliente en TypeScript para consumir esta API desde una aplicación frontend.

---

## B - Herramientas para Generar Clientes

**Definición:**  
Existen varias herramientas para generar clientes a partir de una especificación OpenAPI. Algunas populares son:

1.  **OpenAPI Generator**: Una herramienta de código abierto para generar clientes en múltiples lenguajes.
2.  **openapi-ts**: Especializada en generar clientes TypeScript para frontends.
3.  **Speakeasy**, **Stainless**, **liblab**: Herramientas respaldadas por empresas que ofrecen características adicionales.

**Ejemplo:**

```bash
npm install @hey-api/openapi-ts --save-dev
```

**Descripción del ejemplo:**  
Este comando instala `openapi-ts`, una herramienta para generar clientes TypeScript a partir de una especificación OpenAPI.

---

## C - Generación de un Cliente TypeScript

**Definición:**  
Puedes generar un cliente TypeScript para tu API FastAPI utilizando herramientas como `openapi-ts`. Esto facilita la integración de tu API en aplicaciones frontend, proporcionando autocompletado y validación de tipos.

**Ejemplo:**

1.  Define un script en `package.json` para generar el cliente:

    ```json
    {
      "scripts": {
        "generate-client": "openapi-ts --input http://localhost:8000/openapi.json --output ./src/client --client axios"
      }
    }
    ```

2.  Ejecuta el script:

````bash
 npm run generate-client
 ```

**Descripción del ejemplo:**
Este script genera un cliente TypeScript en la carpeta `./src/client` utilizando `axios` como librería HTTP.

* * *

## D - Uso del Cliente Generado

**Definición:**
El cliente generado proporciona métodos para interactuar con tu API, incluyendo autocompletado para los payloads de solicitud y respuesta, así como validación de tipos.

**Ejemplo:**

```typescript
import { ItemsService } from './client';

const item = { name: "Plumbus", price: 5 };
const response = await ItemsService.createItemItemsPost(item);
console.log(response.message);
````

**Descripción del ejemplo:**  
Este código utiliza el cliente generado para enviar una solicitud POST a la ruta `/items/`. El autocompletado ayuda a asegurar que los datos enviados sean correctos.

---

## E - Etiquetas (Tags) en FastAPI

**Definición:**  
Las etiquetas (tags) en FastAPI permiten organizar las operaciones de tu API en grupos lógicos. Esto es útil para generar clientes más estructurados y fáciles de usar.

**Ejemplo:**

```python
@app.post("/items/", response_model=ResponseMessage, tags=["items"])
async def create_item(item: Item):
    return {"message": "Item received"}
```

**Descripción del ejemplo:**  
Aquí, la operación `create_item` está etiquetada como `items`. Esto ayuda a organizar las operaciones en la documentación y en el cliente generado.

---

## F - Personalización de IDs de Operación

**Definición:**  
FastAPI genera IDs únicos para cada operación en tu API. Puedes personalizar estos IDs para mejorar los nombres de los métodos en el cliente generado.

**Ejemplo:**

```python
def custom_generate_unique_id(route: APIRoute):
    return f"{route.tags[0]}-{route.name}"

app = FastAPI(generate_unique_id_function=custom_generate_unique_id)
```

**Descripción del ejemplo:**  
Este código personaliza la generación de IDs de operación, utilizando el nombre de la etiqueta y el nombre de la función. Esto resulta en nombres de métodos más limpios en el cliente generado.

---

## G - Preprocesamiento de la Especificación OpenAPI

**Definición:**  
Puedes modificar la especificación OpenAPI antes de generar el cliente para mejorar los nombres de los métodos y eliminar información redundante.

**Ejemplo (Python):**

```python
import json
from pathlib import Path

file_path = Path("./openapi.json")
openapi_content = json.loads(file_path.read_text())

for path_data in openapi_content["paths"].values():
    for operation in path_data.values():
        tag = operation["tags"][0]
        operation_id = operation["operationId"]
        new_operation_id = operation_id.replace(f"{tag}-", "")
        operation["operationId"] = new_operation_id

file_path.write_text(json.dumps(openapi_content))
```

**Descripción del ejemplo:**  
Este script elimina el prefijo de la etiqueta en los IDs de operación, lo que resulta en nombres de métodos más limpios en el cliente generado.

---

## H - Beneficios de los Clientes Generados

**Definición:**  
Los clientes generados automáticamente ofrecen:

1.  **Autocompletado**: Para métodos, payloads de solicitud y respuesta.
2.  **Validación de tipos**: Detecta errores en tiempo de desarrollo.
3.  **Sincronización**: Los cambios en la API se reflejan automáticamente en el cliente.

**Ejemplo:**

```typescript
const response = await ItemsService.getItems();
console.log(response[0].name); // Autocompletado para `name` y `price`
```

**Descripción del ejemplo:**  
El cliente generado proporciona autocompletado y validación de tipos, lo que facilita el desarrollo y reduce errores.
