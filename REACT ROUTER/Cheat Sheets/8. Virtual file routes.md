## A - ¬øQu√© son las Virtual File Routes?

#### 1. **Definici√≥n:**

Las Virtual File Routes son como un **mapa hecho a mano** para tus rutas. En lugar de que TanStack Router adivine las rutas bas√°ndose en la estructura de tus archivos, t√∫ le dices **exactamente** qu√© ruta corresponde a cada archivo. Es como darle instrucciones precisas en lugar de dejar que se oriente solo.

#### 2. **Ejemplo:**

Imagina que quieres que la ruta `/dashboard/invoices` muestre el contenido del archivo `app/dashboard-invoices.tsx`. Con Virtual File Routes, lo defines as√≠:

```tsx
import { rootRoute, route } from "@tanstack/virtual-file-routes";

export const routes = rootRoute("root.tsx", [
  route("/dashboard/invoices", "app/dashboard-invoices.tsx"),
]);
```

**Explicaci√≥n del ejemplo:**
Aqu√≠ le estamos diciendo a TanStack Router: "Oye, cuando alguien vaya a `/dashboard/invoices`, muestra lo que hay en `app/dashboard-invoices.tsx`". ¬°As√≠ de directo!

#### 3. **Notas o advertencias:**

- **Flexibilidad total:** Ideal si ya tienes una estructura de rutas pensada o quieres personalizarla al m√°ximo.
- **Control manual:** T√∫ tienes el control absoluto de c√≥mo se mapean las URLs a tus archivos.

---

## B - ¬øPor qu√© usar Virtual File Routes?

#### 1. **Definici√≥n:**

Usar Virtual File Routes te da **superpoderes** para organizar tus rutas. Es √∫til si:

- **Ya tienes tu organizaci√≥n:** Quieres mantener la estructura de rutas que ya tienes en tu proyecto.
- **Ubicaci√≥n personalizada:** Necesitas que tus archivos de ruta est√©n en carpetas espec√≠ficas, no en las convencionales.
- **Convenci√≥n propia:** Quieres ignorar completamente c√≥mo TanStack Router organiza las rutas por defecto y crear tu propio sistema.

#### 2. **Ejemplo:**

Piensa que tienes archivos en carpetas muy espec√≠ficas y no quieres moverlos para que encajen con la convenci√≥n autom√°tica. Con Virtual File Routes, puedes decirle al router d√≥nde encontrar cada archivo, sin importar d√≥nde est√©.

#### 3. **Notas o advertencias:**

- **Para casos espec√≠ficos:** No siempre son necesarias. Si la convenci√≥n de nombres de TanStack Router te funciona, ¬°genial! Pero si necesitas m√°s control, esta es la opci√≥n.

---

## C - Configuraci√≥n de Virtual File Routes

#### 1. **Definici√≥n:**

Hay dos formas principales de decirle a TanStack Router que vas a usar Virtual File Routes:

- **Plugin de TanStack Router (Vite/Rspack/Webpack):** Si usas estas herramientas, es la forma m√°s com√∫n.
- **Archivo `tsr.config.json` (CLI de TanStack Router):** Si usas la l√≠nea de comandos de TanStack Router.

#### 2. **Ejemplo:**

**Usando el plugin de Vite:**

```tsx
// vite.config.ts
import { defineConfig } from "vite";
import { TanStackRouterVite } from "@tanstack/router-plugin/vite";

export default defineConfig({
  plugins: [
    TanStackRouterVite({
      virtualRouteConfig: "./routes.ts", // üëà Aqu√≠ le decimos d√≥nde est√° tu archivo de rutas virtuales
    }),
  ],
});
```

**Explicaci√≥n del ejemplo:**
En `vite.config.ts`, le indicamos al plugin `TanStackRouterVite` que la configuraci√≥n de rutas virtuales est√° en el archivo `./routes.ts`.

#### 3. **Notas o advertencias:**

- **Elige una forma:** No necesitas configurar de ambas maneras, ¬°solo la que uses en tu proyecto!

---

## D - Funciones para crear Virtual File Routes

#### 1. **Definici√≥n:**

Para crear tus rutas virtuales, usar√°s funciones especiales del paquete `@tanstack/virtual-file-routes`. Aqu√≠ las principales:

- `rootRoute`: Para la ruta ra√≠z, la base de todo.
- `route`: Para rutas normales con una URL espec√≠fica.
- `index`: Para la ruta que se muestra cuando est√°s en la ruta "padre" (la p√°gina principal de una secci√≥n).
- `layout`: Para rutas que comparten un dise√±o o "layout" com√∫n.
- `physical`: Para "montar" rutas basadas en archivos dentro de tus rutas virtuales.

#### 2. **Ejemplo:**

```tsx
import {
  rootRoute,
  route,
  index,
  layout,
  physical,
} from "@tanstack/virtual-file-routes";
```

**Explicaci√≥n del ejemplo:**
Simplemente importas estas funciones desde el paquete y las usas para definir tu √°rbol de rutas.

#### 3. **Notas o advertencias:**

- **Importa lo necesario:** Solo importa las funciones que vayas a usar en tu archivo de rutas.

---

## E - `rootRoute`: La Ruta Ra√≠z Virtual

#### 1. **Definici√≥n:**

`rootRoute` es como el **punto de partida** de todas tus rutas virtuales. Siempre necesitas una `rootRoute` para empezar a definir tu √°rbol de rutas.

#### 2. **Ejemplo:**

```tsx
// routes.ts
import { rootRoute } from "@tanstack/virtual-file-routes";

export const routes = rootRoute("root.tsx", [
  // ... aqu√≠ van las rutas "hijas"
]);
```

**Explicaci√≥n del ejemplo:**
`rootRoute('root.tsx', [...])` crea la ruta ra√≠z. `'root.tsx'` indica el archivo que se usar√° para esta ruta ra√≠z (normalmente tu componente de layout principal). Dentro del array `[...]` defines las rutas que cuelgan de esta ra√≠z.

#### 3. **Notas o advertencias:**

- **Una sola ra√≠z:** Solo puedes tener una `rootRoute` principal en tu aplicaci√≥n.
- **Siempre presente:** Es la base de todo el sistema de rutas virtuales.

---

## F - `route`: Rutas Virtuales Normales

#### 1. **Definici√≥n:**

`route` sirve para crear rutas con una **URL espec√≠fica** y un archivo asociado.

#### 2. **Ejemplo:**

```tsx
// routes.ts
import { rootRoute, route } from "@tanstack/virtual-file-routes";

export const routes = rootRoute("root.tsx", [
  route("/about", "about.tsx", [
    // ... rutas "hijas" de /about (si las hay)
  ]),
]);
```

**Explicaci√≥n del ejemplo:**
`route('/about', 'about.tsx', [...])` crea una ruta para `/about`. `'about.tsx'` es el archivo que se mostrar√° cuando alguien visite `/about`. De nuevo, puedes a√±adir rutas "hijas" dentro del array `[...]`.

#### 3. **Notas o advertencias:**

- **Path y archivo:** Necesitas especificar la URL (`/about` en el ejemplo) y el archivo (`about.tsx`).
- **Rutas anidadas:** Puedes crear rutas dentro de rutas para URLs m√°s complejas.

---

## G - `index`: La Ruta √çndice Virtual

#### 1. **Definici√≥n:**

`index` define qu√© se muestra cuando alguien visita la **ruta "padre"** de una secci√≥n. Piensa en la p√°gina principal de un directorio.

#### 2. **Ejemplo:**

```tsx
import { rootRoute, index, route } from "@tanstack/virtual-file-routes";

const routes = rootRoute("root.tsx", [
  route("/products", "products-layout.tsx", [
    // Layout para productos
    index("products-index.tsx"), // üëà P√°gina principal de productos (en /products)
    route("/:productId", "product-detail.tsx"), // Detalle de producto (en /products/:productId)
  ]),
]);
```

**Explicaci√≥n del ejemplo:**
Aqu√≠, `index('products-index.tsx')` dice que cuando alguien vaya a `/products` (sin nada m√°s despu√©s), se mostrar√° `products-index.tsx`.

#### 3. **Notas o advertencias:**

- **Ruta por defecto:** Es la p√°gina de inicio dentro de una ruta "padre".
- **Sin path:** `index` no necesita un path, ya que "hereda" el path de su ruta padre.

---

## H - `layout`: Rutas de Layout Virtual

#### 1. **Definici√≥n:**

`layout` te permite agrupar rutas que comparten un **mismo dise√±o**. √ötil para men√∫s, headers, footers, etc., que son comunes a varias p√°ginas.

#### 2. **Ejemplo:**

```tsx
// routes.ts
import { rootRoute, layout } from "@tanstack/virtual-file-routes";

export const routes = rootRoute("root.tsx", [
  layout("dashboard-layout.tsx", [
    // Layout para el dashboard
    // ... rutas que usan dashboard-layout.tsx
  ]),
]);
```

**Explicaci√≥n del ejemplo:**
`layout('dashboard-layout.tsx', [...])` crea un layout usando `dashboard-layout.tsx`. Todas las rutas dentro de `[...]` usar√°n este layout.

#### 3. **Notas o advertencias:**

- **Dise√±o compartido:** Reutiliza componentes de layout para m√∫ltiples rutas.
- **Opcional ID:** Puedes darle un ID al layout (`layout('my-layout-id', 'layout.tsx', [...])`) si necesitas referenciarlo de forma espec√≠fica.

---

## I - `physical`: Rutas Virtuales F√≠sicas

#### 1. **Definici√≥n:**

`physical` es como **"montar"** un directorio entero de rutas basadas en archivos dentro de tus rutas virtuales. Si tienes una parte de tu app que ya usa la convenci√≥n de nombres de TanStack Router, puedes integrarla f√°cilmente.

#### 2. **Ejemplo:**

Imagina esta estructura de archivos:

```
/routes
‚îú‚îÄ‚îÄ root.tsx
‚îú‚îÄ‚îÄ index.tsx
‚îú‚îÄ‚îÄ layout.tsx
‚îî‚îÄ‚îÄ posts  // üëà Directorio con rutas basadas en archivos
    ‚îú‚îÄ‚îÄ index.tsx
    ‚îú‚îÄ‚îÄ $postId.tsx
    ‚îî‚îÄ‚îÄ ...
```

Y este c√≥digo de rutas virtuales:

```tsx
// routes.ts
import {
  rootRoute,
  layout,
  physical,
  index,
  route,
} from "@tanstack/virtual-file-routes";

export const routes = rootRoute("root.tsx", [
  index("index.tsx"),
  layout("layout.tsx", [
    route("/dashboard", "app/dashboard.tsx", [
      // ... otras rutas virtuales
    ]),
    physical("/posts", "posts"), // üëà Montamos el directorio 'posts' en la ruta /posts
  ]),
]);
```

**Explicaci√≥n del ejemplo:**
`physical('/posts', 'posts')` le dice a TanStack Router: "Todo lo que est√© dentro del directorio `posts` (relativo a tu carpeta de rutas) se va a servir bajo la URL `/posts`". ¬°As√≠, las rutas dentro de `posts` (como `index.tsx`, `$postId.tsx`, etc.) funcionar√°n autom√°ticamente bajo `/posts`!

#### 3. **Notas o advertencias:**

- **Reutiliza rutas basadas en archivos:** Perfecto para integrar partes de tu app que ya usan la convenci√≥n de nombres.
- **"Montaje" de directorio:** Piensa en ello como conectar un directorio de rutas a una URL espec√≠fica dentro de tus rutas virtuales.

---

## J - Virtual Routes dentro de File-Based Routing (y viceversa)

#### 1. **Definici√≥n:**

¬°La magia de TanStack Router! Puedes **mezclar y combinar** rutas virtuales y rutas basadas en archivos como quieras.

- **Virtual dentro de File-Based:** Puedes tener la estructura principal de rutas basada en archivos y usar rutas virtuales para sub√°rboles espec√≠ficos.
- **File-Based dentro de Virtual:** Como vimos con `physical`, puedes "montar" rutas basadas en archivos dentro de un √°rbol de rutas virtuales.

#### 2. **Ejemplo: Virtual dentro de File-Based**

Imagina esta estructura:

```
/routes
‚îú‚îÄ‚îÄ __root.tsx
‚îú‚îÄ‚îÄ foo
‚îÇ   ‚îú‚îÄ‚îÄ bar
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __virtual.ts  // üëà ¬°Aqu√≠ activamos rutas virtuales!
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ details.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ home.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ route.ts
‚îÇ   ‚îî‚îÄ‚îÄ bar.tsx
‚îî‚îÄ‚îÄ index.tsx
```

El archivo `__virtual.ts` dentro de `foo/bar` le dice a TanStack Router: "¬°Oye! Para todo lo que est√© dentro de `foo/bar` (y sus subcarpetas), vamos a usar rutas virtuales, no la convenci√≥n de nombres autom√°tica".

**Contenido de `__virtual.ts`:**

```tsx
// routes/foo/bar/__virtual.ts
import {
  defineVirtualSubtreeConfig,
  index,
  route,
} from "@tanstack/virtual-file-routes";

export default defineVirtualSubtreeConfig([
  index("home.tsx"),
  route("$id", "details.tsx"),
]);
```

**Explicaci√≥n del ejemplo:**
`__virtual.ts` define las rutas para `/foo/bar` y sus "hijas" usando las funciones `index` y `route`. `defineVirtualSubtreeConfig` es una funci√≥n auxiliar para configurar este sub√°rbol virtual.

#### 3. **Notas o advertencias:**

- `__virtual.ts`: El archivo clave para activar rutas virtuales dentro de la convenci√≥n de nombres.
- `defineVirtualSubtreeConfig`: Facilita la definici√≥n de la configuraci√≥n de rutas virtuales en `__virtual.ts`.
- **Flexibilidad m√°xima:** Adapta las rutas a las necesidades exactas de cada parte de tu aplicaci√≥n.

---

## K - Configuraci√≥n con `tsr.config.json` (CLI)

#### 1. **Definici√≥n:**

Si usas la CLI de TanStack Router, configuras las Virtual File Routes en el archivo `tsr.config.json`.

#### 2. **Ejemplo:**

**Opci√≥n 1: Indicar el archivo de rutas virtuales:**

```json
// tsr.config.json
{
  "virtualRouteConfig": "./routes.ts" // üëà  Ruta a tu archivo de rutas virtuales
}
```

**Opci√≥n 2: Definir las rutas directamente en JSON (menos com√∫n):**

```json
// tsr.config.json
{
  "virtualRouteConfig": {
    // üëà Configuraci√≥n de rutas virtuales en JSON
    "type": "root",
    "file": "root.tsx",
    "children": [
      {
        "type": "index",
        "file": "home.tsx"
      }
      // ... m√°s rutas en formato JSON
    ]
  }
}
```

**Explicaci√≥n del ejemplo:**
En `tsr.config.json`, puedes especificar la ruta a tu archivo de rutas virtuales (`./routes.ts`) o, menos com√∫n, definir la estructura de rutas directamente en JSON.

#### 3. **Notas o advertencias:**

- **JSON o archivo:** Elige la opci√≥n que te resulte m√°s c√≥moda. Usar un archivo (`./routes.ts`) suele ser m√°s legible y f√°cil de mantener.
- **Formato JSON:** Si defines las rutas en JSON, aseg√∫rate de seguir la estructura correcta (tipo, archivo, path, children, etc.).
