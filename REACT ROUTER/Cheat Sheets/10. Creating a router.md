## A - Crear un Router con `createRouter`

#### 1. **Definición:**

Para empezar a usar TanStack Router, necesitas crear una instancia de `Router`. Piensa en esta instancia como el cerebro de tu sistema de rutas. Es quien se encarga de entender tu árbol de rutas, encontrar la ruta correcta para cada URL y gestionar la navegación entre páginas. Lo creas usando la función `createRouter`.

#### 2. **Ejemplo:**

```tsx
import { createRouter } from "@tanstack/react-router";

const router = createRouter({
  // Aquí irán las opciones de configuración, como el árbol de rutas
});
```

**Explicación del ejemplo:**
Importamos `createRouter` desde la librería y la usamos para crear nuestro `router`. Por ahora, lo dejamos casi vacío, pero ya verás cómo lo vamos a ir llenando de cosas interesantes.

#### 3. **Notas o advertencias:**

- Recuerda importar `createRouter` desde `'@tanstack/react-router'`. ¡Es el primer paso!
- El objeto que pasamos a `createRouter` es donde configuraremos todo lo relacionado con nuestro router.

## B - El Árbol de Rutas (`routeTree`)

#### 1. **Definición:**

El `routeTree` es como el mapa de tu aplicación web. Define todas las rutas posibles y cómo se organizan entre sí. Esencialmente, le dice a tu router qué componentes mostrar para cada URL. Puedes crearlo de dos maneras principales: usando la estructura de carpetas de tu proyecto (file-based routing) o escribiendo el árbol de rutas directamente en código (code-based routing).

#### 2. **Ejemplo:**

Imagina que ya tienes tu `routeTree` creado (ya sea automáticamente o a mano). Para usarlo al crear el router, lo pasas como una opción:

```tsx
import { createRouter } from "@tanstack/react-router";
import { routeTree } from "./routeTree.gen"; // o donde tengas tu routeTree

const router = createRouter({
  routeTree: routeTree, // ¡Aquí lo usamos!
});
```

**Explicación del ejemplo:**
Aquí vemos cómo conectar nuestro `routeTree` con el router. La opción `routeTree` espera precisamente eso, ¡tu árbol de rutas!

#### 3. **Notas o advertencias:**

- Sin un `routeTree`, el router no sabrá qué rutas existen en tu aplicación. ¡Es fundamental!
- Más adelante veremos cómo crear este `routeTree` de las dos maneras posibles.

## C - Árbol de Rutas Basado en Archivos (Filesystem Route Tree)

#### 1. **Definición:**

Esta es la forma recomendada y más sencilla de crear tu `routeTree`, especialmente para proyectos grandes. TanStack Router analiza la estructura de carpetas y archivos dentro de un directorio específico (normalmente `src/routes`) y automáticamente genera el `routeTree` por ti. ¡Magia pura! ✨

#### 2. **Ejemplo:**

Si estás usando este método, es muy probable que ya tengas un archivo llamado `routeTree.gen.ts` (o similar) generado automáticamente en `src/`. Simplemente impórtalo y úsalo:

```tsx
import { routeTree } from "./routeTree.gen"; // Importa tu routeTree generado

// ... luego, en createRouter como vimos antes
const router = createRouter({
  routeTree: routeTree,
});
```

**Explicación del ejemplo:**
¡Así de fácil! TanStack Router se encarga de todo el trabajo pesado de generar el árbol de rutas a partir de tus archivos. Tú solo tienes que importarlo y pasárselo al router.

#### 3. **Notas o advertencias:**

- Asegúrate de que tu `routeTree.gen.ts` se genere correctamente. Normalmente, esto se hace con un script o comando que TanStack Router proporciona.
- Si cambias la estructura de tus carpetas en `src/routes`, ¡recuerda regenerar el `routeTree.gen.ts`!

## D - Árbol de Rutas Basado en Código (Code-Based Route Tree)

#### 1. **Definición:**

Si prefieres tener más control o si tu proyecto tiene una estructura más compleja, puedes definir tu `routeTree` directamente en código. Esto implica crear las rutas manualmente usando las clases y métodos que TanStack Router te da.

#### 2. **Ejemplo:**

```tsx
import { createRootRoute } from "@tanstack/react-router";

const rootRoute = createRootRoute();

const routeTree = rootRoute.addChildren([
  // Aquí defines tus rutas hijas, por ejemplo:
  // { path: '/', component: HomePage },
  // { path: '/about', component: AboutPage },
]);

// ... luego, en createRouter
const router = createRouter({
  routeTree: routeTree,
});
```

**Explicación del ejemplo:**
Empezamos creando una ruta raíz (`rootRoute`) y luego usamos `.addChildren()` para añadir rutas hijas. Dentro de `addChildren`, definirías cada ruta con su `path` (la URL) y el `component` (el componente de React que se mostrará).

#### 3. **Notas o advertencias:**

- Este método te da más flexibilidad, pero también requiere más trabajo manual.
- Asegúrate de entender bien cómo funcionan las rutas padre e hijas al usar este método.

## E - Seguridad de Tipado del Router (Router Type Safety) ¡IMPORTANTE! ⚠️

#### 1. **Definición:**

TanStack Router está diseñado para funcionar de maravilla con TypeScript. ¡Incluso con cosas que parecen magia! ✨ Para que TypeScript entienda completamente tu router y te dé toda la ayuda posible (autocompletado, detección de errores, etc.), necesitas registrar los tipos de tu router. Esto se hace usando una característica de TypeScript llamada "Declaration Merging" (fusión de declaraciones).

#### 2. **Ejemplo:**

```tsx
import { createRouter } from "@tanstack/react-router";
import { routeTree } from "./routeTree.gen";

const router = createRouter({
  routeTree,
});

// ⚠️ ¡AÑADE ESTO EN ALGÚN LUGAR DE TU PROYECTO, por ejemplo, en el mismo archivo donde creas el router! ⚠️
declare module "@tanstack/react-router" {
  interface Register {
    router: typeof router; // ¡Registra el tipo de tu router aquí!
  }
}
```

**Explicación del ejemplo:**
Este código `declare module '@tanstack/react-router' { ... }` le dice a TypeScript que vamos a añadir algo a la definición de `'@tanstack/react-router'`. Dentro, definimos una interfaz `Register` y dentro de ella, una propiedad `router` cuyo tipo es `typeof router`. `typeof router` "captura" el tipo exacto de tu router que creaste con `createRouter`.

#### 3. **Notas o advertencias:**

- **¡NO TE SALTES ESTO!** Si no haces esto, te perderás gran parte del poder de TanStack Router con TypeScript.
- Solo necesitas hacer esto **una vez** en tu proyecto. Puedes poner este bloque de código en el mismo archivo donde creas tu router o en un archivo de tipos global.
- Después de hacer esto, TypeScript entenderá tu router en todo tu proyecto y te dará una experiencia de desarrollo mucho mejor.

## F - Ruta "No Encontrada" (`notFoundRoute`)

#### 1. **Definición:**

¿Qué pasa cuando un usuario intenta acceder a una URL que no existe en tu aplicación? Normalmente, quieres mostrar una página de "Error 404: No Encontrado". La opción `notFoundRoute` te permite configurar una ruta especial que se mostrará precisamente en esos casos, cuando ninguna otra ruta coincide con la URL.

#### 2. **Ejemplo con File-Based Routing:**

```tsx
import { NotFoundRoute } from "@tanstack/react-router";
import { Route as rootRoute } from "./routes/__root.tsx"; // Importa tu ruta raíz generada

const notFoundRoute = new NotFoundRoute({
  getParentRoute: () => rootRoute, // La ruta "no encontrada" cuelga de la raíz
  component: () => "<h1>404 Not Found</h1>", // Componente para mostrar
});

const router = createRouter({
  routeTree,
  notFoundRoute: notFoundRoute, // ¡Añade la ruta "no encontrada" al router!
});
```

**Explicación del ejemplo:**
Creamos una instancia de `NotFoundRoute`. Le decimos que su ruta padre es la `rootRoute` (la raíz de tu árbol de rutas). Y le definimos un `component` que se mostrará cuando se active esta ruta (en este caso, un simple `<h1>404 Not Found</h1>`). Finalmente, pasamos `notFoundRoute` como una opción al `createRouter`.

#### 3. **Ejemplo con Code-Based Routing:**

```tsx
import { NotFoundRoute, createRootRoute } from "@tanstack/react-router";

const rootRoute = createRootRoute();

// ... aquí iría la definición de tu routeTree con rootRoute.addChildren(...)

const notFoundRoute = new NotFoundRoute({
  getParentRoute: () => rootRoute,
  component: () => "<h1>404 Not Found</h1>",
});

const router = createRouter({
  routeTree,
  notFoundRoute: notFoundRoute,
});
```

**Explicación del ejemplo:**
Es muy similar al ejemplo con File-Based Routing. La diferencia principal es que aquí estamos creando `rootRoute` manualmente con `createRootRoute()`, ya que estamos en un contexto de Code-Based Routing. El resto del código para `notFoundRoute` es igual.

#### 4. **Notas o advertencias:**

- Es muy recomendable configurar una `notFoundRoute` para dar una buena experiencia de usuario cuando se introducen URLs incorrectas.
- Puedes personalizar el componente de la `notFoundRoute` para que sea una página 404 más elaborada, con enlaces a la página principal, etc.

## G - Otras Opciones de Configuración

#### 1. **Definición:**

La opción `routeTree` y `notFoundRoute` son solo algunas de las cosas que puedes configurar al crear tu router con `createRouter`. Existen muchas otras opciones para personalizar el comportamiento del router, como la gestión del historial de navegación, la configuración de enlaces, etc.

#### 2. **Ejemplo:**

```tsx
const router = createRouter({
  routeTree,
  notFoundRoute,
  // ... otras opciones que puedes añadir aquí:
  // base: '/mi-app', // Para definir una base URL
  // defaultPreload: 'intent', // Para precargar datos al hacer hover en enlaces
  // ... ¡y muchas más!
});
```

**Explicación del ejemplo:**
Aquí te muestro que dentro del objeto de configuración de `createRouter` puedes añadir más opciones además de `routeTree` y `notFoundRoute`. `base` y `defaultPreload` son solo ejemplos, ¡hay muchas más!

#### 3. **Notas o advertencias:**

- Para ver la lista completa de opciones, consulta la [API Reference de TanStack Router](https://tanstack.com/router/latest/docs/framework/react/api/router/RouterOptionsType). ¡Ahí encontrarás toda la información detallada!
- Explora las opciones para ver si alguna te puede ser útil para las necesidades específicas de tu proyecto.
