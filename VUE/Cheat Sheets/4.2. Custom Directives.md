## A - Custom Directives

**Definición:** Las directivas personalizadas son una forma de reutilizar lógica que implica manipulación directa del DOM en elementos HTML. A diferencia de los componentes (que son bloques de construcción principales) y los composables (que reutilizan lógica con estado), las directivas se centran en interacciones de bajo nivel con el DOM.

**Ejemplo:**

```Vue
<script setup>
// Define una directiva que agrega una clase al elemento al montarse
const vHighlight = {
  mounted: (el) => {
    el.classList.add('is-highlight');
  }
};
</script>

<template>
  <p v-highlight>Este texto es importante.</p>
</template>
```

(En este ejemplo, vHighlight es una directiva que agrega la clase is-highlight al elemento `<p>` cuando se inserta en el DOM. Se usa en la plantilla como v-highlight.)

## B - Registro de Directivas

**Definición:** Las directivas personalizadas se pueden registrar de tres maneras:

En `<script setup>`: Cualquier variable camelCase que comience con v se puede usar como directiva en la plantilla (ej: vHighlight se usa como v-highlight).

En la opción directives: Se registran dentro de la opción directives de un componente.

Globalmente: Se registran a nivel de la aplicación para que estén disponibles en todos los componentes.

**Ejemplo:**

```Js
// Registro global
const app = createApp({});

app.directive('highlight', {
  mounted: (el) => {
    el.classList.add('is-highlight');
  }
});

// Registro en un componente (sin <script setup>)
export default {
  directives: {
    highlight: {
      mounted: (el) => {
        el.classList.add('is-highlight');
      }
    }
  }
}
```

(El primer ejemplo muestra cómo registrar una directiva globalmente, haciéndola accesible en toda la aplicación. El segundo ejemplo muestra cómo registrar una directiva dentro de un componente específico.)

## C - Casos de Uso de Directivas

**Definición:** Las directivas personalizadas deben usarse cuando la funcionalidad deseada solo se puede lograr mediante la manipulación directa del DOM. Un ejemplo común es una directiva v-focus para enfocar un elemento.

**Ejemplo:**

```Vue
<script setup>
// Define una directiva que enfoca el elemento al montarse
const vFocus = {
  mounted: (el) => el.focus()
};
</script>

<template>
  <input v-focus />
</template>
```

(En este ejemplo, vFocus enfoca el elemento `<input>` cuando se inserta en el DOM, lo cual es más útil que el atributo autofocus porque funciona dinámicamente.)

## D - Hooks de Directivas

**Definición:** Las directivas personalizadas pueden tener varios hooks de ciclo de vida (todos opcionales), similares a los de un componente. Estos hooks permiten ejecutar código en diferentes momentos del ciclo de vida del elemento al que se aplica la directiva.

**Ejemplo:**

```Js
const myDirective = {
  created(el, binding, vnode) {
    // Se llama antes de aplicar atributos o listeners
  },
  beforeMount(el, binding, vnode) {
    // Se llama antes de insertar el elemento en el DOM
  },
  mounted(el, binding, vnode) {
    // Se llama cuando el componente padre y sus hijos se montan
  },
  beforeUpdate(el, binding, vnode, prevVnode) {
    // Se llama antes de que el componente padre se actualice
  },
  updated(el, binding, vnode, prevVnode) {
    // Se llama después de que el componente padre y sus hijos se actualizan
  },
  beforeUnmount(el, binding, vnode) {
    // Se llama antes de desmontar el componente padre
  },
  unmounted(el, binding, vnode) {
    // Se llama cuando se desmonta el componente padre
  }
};
```

(Este ejemplo muestra todos los hooks disponibles en una directiva, cada uno con su momento de ejecución específico.)

## E - Argumentos de Hooks

**Definición:** Los hooks de directivas reciben argumentos que proporcionan información sobre el elemento y el contexto de la directiva. Estos argumentos son: el (el elemento DOM), binding (un objeto con información sobre la directiva), vnode (el VNode del elemento) y prevVnode (el VNode anterior, solo en beforeUpdate y updated).

**Ejemplo:**

```Js
const myDirective = {
  mounted(el, binding, vnode) {
    console.log(el); // El elemento DOM
    console.log(binding.value); // El valor pasado a la directiva
    console.log(binding.arg); // El argumento de la directiva
    console.log(binding.modifiers); // Los modificadores de la directiva
    console.log(binding.instance); // La instancia del componente
    console.log(binding.dir); // La definición de la directiva
    console.log(vnode); // El VNode del elemento
  }
};
```

(Este ejemplo muestra cómo acceder a los diferentes argumentos dentro de un hook de directiva. binding contiene información como el valor, el argumento y los modificadores de la directiva.)

## F - Uso de Argumentos Dinámicos

**Definición:** Los argumentos de las directivas pueden ser dinámicos, lo que significa que su valor puede cambiar reactivamente según el estado del componente.

**Ejemplo:**

```Vue
<template>
  <div v-example:[arg]="value"></div>
</template>

<script setup>
import { ref } from 'vue';
const arg = ref('foo');
const value = ref('bar');
</script>
```

(En este ejemplo, el argumento de la directiva v-example se actualiza reactivamente según el valor de la variable arg.)

## G - Shorthand de Función

**Definición:** Si una directiva tiene el mismo comportamiento en mounted y updated, se puede definir como una función en lugar de un objeto.

**Ejemplo:**

```Js
app.directive('color', (el, binding) => {
  el.style.color = binding.value;
});
```

(En este ejemplo, la directiva v-color se define como una función que se ejecuta tanto en mounted como en updated, estableciendo el color del elemento.)

## H - Literales de Objeto

**Definición:** Las directivas pueden recibir literales de objeto como valor, lo que permite pasar múltiples valores a la directiva.

**Ejemplo:**

```Vue
<template>
  <div v-demo="{ color: 'white', text: 'hello!' }"></div>
</template>

<script setup>
app.directive('demo', (el, binding) => {
  console.log(binding.value.color); // => "white"
  console.log(binding.value.text); // => "hello!"
});
</script>
```

(En este ejemplo, la directiva v-demo recibe un objeto con las propiedades color y text, que se pueden usar dentro de la directiva.)

## I - Uso en Componentes

**Definición:** No se recomienda usar directivas personalizadas en componentes. Las directivas se aplican al nodo raíz del componente, y pueden surgir comportamientos inesperados si el componente tiene múltiples nodos raíz.

**Ejemplo:**

```Vue
<template>
  <MyComponent v-demo="test" />
</template>

<!-- Template de MyComponent -->
<div> <!-- v-demo se aplica aquí -->
  <span>Contenido del componente</span>
</div>
```

(En este ejemplo, la directiva v-demo se aplica al elemento `<div>` raíz del componente MyComponent. Si MyComponent tuviera múltiples nodos raíz, la directiva sería ignorada.)
