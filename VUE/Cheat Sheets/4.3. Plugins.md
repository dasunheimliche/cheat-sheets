## A - Plugins

**Definición:** Los plugins en Vue son fragmentos de código autocontenido que extienden la funcionalidad de la aplicación. Piensa en ellos como "complementos" o "extensiones" que añaden nuevas capacidades a tu aplicación. Son como "aplicaciones" más pequeñas que puedes "instalar" en tu proyecto Vue para lograr tareas más complejas, cómo gestionar el enrutamiento de las vistas (como vue-router), gestionar un estado global (como pinia o vuex) o para otras tareas de alto nivel, como el soporte para la internacionalización de un sitio web (como el ejemplo que veremos en la sección `B`).

**Ejemplo:** Un plugin básico que registra un componente global `Alert`.

```js
// plugins/alertPlugin.js
import Alert from "../components/Alert.vue";
export default {
  install(app) {
    app.component("Alert", Alert);
  },
};
```

```js
// main.js
import { createApp } from "vue";
import App from "./App.vue";
import alertPlugin from "./plugins/alertPlugin";

const app = createApp(App);
app.use(alertPlugin);
app.mount("#app");
```

**Descripción del ejemplo:** El plugin `alertPlugin` importa el componente `Alert` y lo registra globalmente con `app.component()`. En `main.js`, el plugin se instala con `app.use()`, haciendo que el componente `<Alert>` esté disponible en cualquier parte de la aplicación sin necesidad de importarlo localmente.

## B - Casos de Uso de Plugins

**Definición:** Los plugins son útiles en una variedad de escenarios, donde se necesita añadir funcionalidades al nivel de la aplicación. Es como tener un "caja de herramientas" que puedes "instalar" en tu taller de trabajo, y que incluye herramientas que se usarán en múltiples proyectos. Los casos de uso más comunes son:

1. Registrar componentes o directivas globales.
2. Inyectar recursos mediante `provide/inject`.
3. Añadir propiedades o métodos globales.
4. Envolver librerías con múltiples funcionalidades.

**Ejemplo:**

- Un plugin para registrar directivas (como `v-focus`).
- Un plugin para manejar el estado global (`app.provide`).
- Un plugin para internacionalización (`i18n`) (como en el ejemplo del texto original).
- Un plugin para integrar una librería de terceros, como un componente de mapas, gráficos, etc.

```js
// plugin para registrar directivas
export default {
  install(app) {
    app.directive("focus", {
      mounted: (el) => el.focus(),
    });
  },
};
```

```js
// plugin para gestionar el estado global
export default {
  install(app) {
    app.provide("globalState", {
      count: 0,
      increment() {
        this.count++;
      },
    });
  },
};
```

```js
// plugin para i18n (simplificado)
export default {
  install(app, options) {
    app.config.globalProperties.$translate = (key) => {
      return key.split(".").reduce((o, i) => {
        if (o) return o[i];
      }, options);
    };
  },
};
```

**Descripción del ejemplo:** Los ejemplos muestran diferentes casos de uso. El primer ejemplo registra la directiva `v-focus`. El segundo proporciona un `globalState` que permite compartir un estado entre componentes. Y el tercero, el caso del texto original de ejemplo, muestra cómo crear un plugin básico para traducciones. En la práctica, se podría combinar varios comportamientos en un único plugin.

## C - Creación de un Plugin

**Definición:** Un plugin se crea como un objeto con un método `install` o simplemente como una función que sirve como `install`. El método `install` recibe la instancia de la aplicación (`app`) y las opciones pasadas al método `app.use()`. Es como escribir la receta para un platillo especial y tenerla lista para cocinar en cualquier ocasión.

**Ejemplo:** Un plugin básico con un método `install` que registra una propiedad global, tal como la traducción del texto original.

```js
// plugins/myPlugin.js
export default {
  install(app, options) {
    app.config.globalProperties.$myPluginMessage =
      options.message || "Mensaje por defecto";
  },
};
```

```js
//main.js
import { createApp } from 'vue'
import App from './App.vue'
import myPlugin from './plugins/myPlugin'

const app = createApp(App)
app.use(myPlugin, { message: 'Hola desde el plugin' })
app.mount('#app')

// App.vue
<template>
    <p>{{ $myPluginMessage }}</p>
</template>
```

**Descripción del ejemplo:** El plugin `myPlugin` define un método `install` que recibe la instancia de la aplicación `app` y las opciones. La opción `message` se define en el `app.use()` y se pasa al plugin. El plugin define una propiedad global `$myPluginMessage` accesible en toda la aplicación. Si no se pasase la propiedad `message`, se usaría el mensaje por defecto.

## D - Propiedades Globales

**Definición:** Un plugin puede agregar propiedades o métodos globales a través de `app.config.globalProperties`. Esto hace que estas propiedades y métodos estén disponibles en cualquier parte de la aplicación, sin necesidad de importarlos o declararlos localmente. Es como tener utilidades o funciones de apoyo disponibles en todas las mesas de trabajo en tu taller, evitando tener que buscarlas en cada proyecto.

**Ejemplo:** Un plugin que agrega una función global `$formatDate` para formatear fechas.

```js
// plugins/datePlugin.js
export default {
  install(app) {
    app.config.globalProperties.$formatDate = (date) => {
      return new Date(date).toLocaleDateString();
    };
  },
};
```

```js
// App.vue
<template>
    <p>Fecha formateada: {{ $formatDate('2024-07-20') }}</p>
</template>
```

**Descripción del ejemplo:** El plugin `datePlugin` define una función global `$formatDate` que recibe una fecha y la devuelve formateada. Esta función se puede usar directamente en la plantilla de cualquier componente, sin necesidad de hacer importaciones ni definiciones adicionales. En el ejemplo, usamos `$formatDate` para formatear la fecha `2024-07-20`.

## E - Provide / Inject con Plugins

**Definición:** Los plugins también pueden usar `provide` para inyectar recursos que pueden ser consumidos por componentes usando `inject`. Esto permite compartir datos o funciones de manera controlada a través de toda la app, especialmente cuando se trabaja con componentes que están muy separados en el árbol de componentes. Es como tener un sistema de tuberías que transporta recursos a diferentes lugares del taller sin necesidad de que cada área los tenga que crear por sí misma.

**Ejemplo:** Un plugin que inyecta un objeto de configuración que puede ser usado por todos los componentes.

```js
// plugins/configPlugin.js
export default {
  install(app, options) {
    app.provide("config", options);
  },
};
```

```js
//Componente
<script setup>
  import {inject} from 'vue' const config = inject('config')
  console.log(config.apiURL)
</script>
```

```js
// main.js
import configPlugin from "./plugins/configPlugin";
app.use(configPlugin, {
  apiURL: "https://api.example.com",
  theme: "dark",
});
```

**Descripción del ejemplo:** El plugin `configPlugin` usa `app.provide` para proporcionar un objeto `config` que contiene opciones de configuración (apiURL y theme). Los componentes que lo necesiten pueden usar `inject` para obtener acceso al objeto `config`, sin necesidad de pasarlo manualmente a cada componente. En el ejemplo el componente accede a `config.apiURL` a través de `inject('config')`.

## F - Agrupar para NPM

**Definición:** Si deseas compartir tu plugin con otros desarrolladores, puedes agruparlo como un paquete de NPM. Esto implica preparar el código, empaquetarlo correctamente y publicarlo en el registro de NPM. Es como llevar el "caja de herramientas" que diseñaste al mercado para que otros la puedan usar.

**Ejemplo:** Consulta la sección "Library Mode" en la documentación de Vite para ver cómo agrupar un plugin para NPM.

**Descripción del ejemplo:** La documentación de Vite proporciona información detallada sobre cómo configurar tu proyecto para compilarlo como una librería (library mode). Esta configuración te permitirá empaquetar el código de tu plugin en un formato que se pueda instalar y usar fácilmente en otros proyectos a través de NPM.
