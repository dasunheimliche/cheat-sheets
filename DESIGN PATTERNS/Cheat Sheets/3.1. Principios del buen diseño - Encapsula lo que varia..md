## A - Encapsula lo que varía (en Java)

#### 1. **Definición:**

Igual que antes, este principio nos dice que identifiquemos las partes de nuestro código Java que pueden cambiar (como reglas de negocio, impuestos, etc.) y las separemos del código que es más estable. ¡Encapsular es como poner esas partes variables en cajitas separadas!

#### 2. **Analogía:**

La del barco y las minas sigue siendo perfecta. Imagina que estás construyendo un barco de código Java. Si encapsulas bien las partes variables, como los compartimentos estancos, tu barco (programa) será más resistente a los "cambios mina".

#### 3. **Beneficios:**

- **Menos refactorización dolorosa:** Cambiar las reglas de impuestos en Java será mucho menos estresante si el código de impuestos está bien encapsulado.
- **Código Java más limpio y mantenible:** Separar responsabilidades hace que tu código sea más fácil de leer, entender y mantener a largo plazo.
- **Reutilización:** Las partes encapsuladas, como un `TaxCalculator` en Java, pueden ser reutilizadas en diferentes partes de tu aplicación o incluso en otros proyectos.

## B - Encapsulación a nivel de método (en Java)

#### 1. **Problema:**

Tienes un método Java, digamos `calcularTotalPedido`, en una clase `Pedido`. Este método calcula el total, ¡pero también se encarga de calcular los impuestos! Si las reglas de impuestos cambian (y en Java, ¡cambian!), tendrás que modificar este método directamente. ¡No es ideal!

#### 2. **Solución:**

Extrae la lógica del cálculo de impuestos a un método Java separado, como `obtenerTasaImpuestos`. Ahora, `calcularTotalPedido` en Java solo se enfoca en el total y llama a `obtenerTasaImpuestos` para la parte de impuestos. ¡Mucho mejor!

#### 3. **Ejemplo ANTES (Java):**

```java
public class Pedido {
    // ... otros atributos del Pedido ...

    public double calcularTotalPedido(Pedido pedido) {
        double total = 0;
        for (ItemDePedido item : pedido.getItems()) {
            total += item.getPrecio() * item.getCantidad();
        }

        if (pedido.getPais().equals("US")) {
            total += total * 0.07; // Impuesto de EEUU
        } else if (pedido.getPais().equals("EU")) {
            total += total * 0.20; // IVA europeo
        }

        return total;
    }
}
```

**Explicación del ejemplo ANTES (Java):**
En este código Java, el cálculo del impuesto está _dentro_ del método `calcularTotalPedido` de la clase `Pedido`. Si las tasas de impuestos cambian, ¡toca modificar este método Java directamente!

#### 4. **Ejemplo DESPUÉS (Java):**

```java
public class Pedido {
    // ... otros atributos del Pedido ...

    public double calcularTotalPedido(Pedido pedido) {
        double total = 0;
        for (ItemDePedido item : pedido.getItems()) {
            total += item.getPrecio() * item.getCantidad();
        }

        total += total * obtenerTasaImpuestos(pedido.getPais());

        return total;
    }

    private double obtenerTasaImpuestos(String pais) {
        if (pais.equals("US")) {
            return 0.07; // Impuesto de EEUU
        } else if (pais.equals("EU")) {
            return 0.20; // IVA europeo
        } else {
            return 0;
        }
    }
}
```

**Explicación del ejemplo DESPUÉS (Java):**
Ahora, en Java, el cálculo del impuesto está en un método privado separado, `obtenerTasaImpuestos`, dentro de la misma clase `Pedido`. `calcularTotalPedido` simplemente _llama_ a este método. ¡Código Java más organizado y listo para cambios en impuestos!

## C - Encapsulación a nivel de clase (en Java)

#### 1. **Problema:**

La clase `Pedido` en Java se está volviendo gigante. Maneja la información del pedido, los ítems, el cliente, ¡y también el cálculo de impuestos! Demasiadas responsabilidades en una sola clase Java.

#### 2. **Solución:**

Crea una clase Java separada, `CalculadorImpuestos`, que se encargue _solo_ de los impuestos. La clase `Pedido` en Java tendrá una instancia de `CalculadorImpuestos` y le delegará el trabajo de calcular impuestos. ¡Cada clase Java con su tarea específica!

#### 3. **Ejemplo ANTES (Java - Conceptual):**

```java
// ANTES: Cálculo de impuestos en la clase Pedido (Java Conceptual)

public class Pedido {
    // ... atributos del Pedido (items, cliente, etc.) ...

    public double getOrderTotal() { // Calcula total e impuestos
        // ... lógica para calcular total + impuestos ...
    }

    public double getTaxRate(String pais, String estado, Producto producto) { // Calcula tasa de impuesto
        // ... lógica para obtener tasa de impuesto ...
    }

    // ... 20+ otros campos y métodos ...
}
```

**Explicación del ejemplo ANTES (Java Conceptual):**
La clase `Pedido` en Java tiene métodos como `getOrderTotal` y `getTaxRate` _dentro_ de ella, mezclando la lógica del negocio del pedido con la lógica de impuestos.

#### 4. **Ejemplo DESPUÉS (Java - Conceptual):**

```java
// DESPUÉS: Cálculo de impuestos en una clase separada (Java Conceptual)

public class Pedido {
    private CalculadorImpuestos calculadorImpuestos; // Referencia al Calculador de Impuestos
    // ... atributos del Pedido (items, cliente, etc.) ...

    public Pedido(CalculadorImpuestos calculadorImpuestos) {
        this.calculadorImpuestos = calculadorImpuestos;
    }

    public double getOrderTotal() { // Calcula total, usa CalculadorImpuestos
        // ... lógica para calcular total ...
        // ... usa calculadorImpuestos para obtener impuestos ...
    }

    // ... otros métodos del Pedido ...
}


public class CalculadorImpuestos {
    public double getTaxRate(String pais, String estado, Producto producto) {
        // ... lógica para obtener tasa de impuesto (más compleja aquí) ...
    }

    public double getUSTax(String estado) {
        // ... lógica específica para impuestos de EEUU por estado ...
    }

    public double getEUTax(String pais) {
        // ... lógica específica para IVA europeo por país ...
    }

    public double getChineseTax(Producto producto) {
        // ... lógica específica para impuestos chinos por producto ...
    }
}
```

**Explicación del ejemplo DESPUÉS (Java Conceptual):**
Ahora tenemos dos clases Java:

- `Pedido`: Se enfoca en la lógica del pedido en sí. Tiene una referencia a `CalculadorImpuestos`.
- `CalculadorImpuestos`: Clase Java _dedicada_ a todo el cálculo de impuestos. Tiene métodos específicos para diferentes tipos de impuestos.

La clase `Pedido` en Java _delega_ el cálculo de impuestos a `CalculadorImpuestos`. ¡Código Java mucho más limpio, organizado y fácil de extender o modificar cuando cambien las reglas de impuestos!

**En resumen (Java):** "Encapsula lo que varía" en Java significa pensar en qué partes de tu código Java pueden cambiar y crear clases y métodos Java separados para manejar esos cambios. ¡Te hará la vida mucho más fácil como programador Java!
