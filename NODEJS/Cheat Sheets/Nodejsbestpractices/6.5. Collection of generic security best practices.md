## A - Seguridad Com√∫n en Node.js: ¬°Lo B√°sico que No Debes Olvidar!

#### 1. **Definici√≥n:**

Estas son las reglas de oro de la seguridad en Node.js. Son como los cimientos de una casa segura: si los tienes bien puestos, ¬°todo lo dem√°s estar√° m√°s protegido!

## B - üîí ¬°Cifra la Conexi√≥n con SSL/TLS!

#### 1. **Definici√≥n:**

SSL/TLS es como un "candado" para la comunicaci√≥n entre el navegador del usuario y tu servidor. Cifra la informaci√≥n para que nadie pueda espiar lo que se env√≠a y recibe. ¬°Es fundamental, especialmente si manejas datos sensibles!

#### 2. **Ejemplo:**

Imagina que tu sitio web es `http://mi-sitio.com`. ¬°Eso no es seguro! Debes usar `https://mi-sitio.com`. La 's' al final significa "seguro" (SSL/TLS).

#### 3. **Notas o advertencias:**

- **¬°Ya no hay excusa!** Con servicios como [Let's Encrypt](https://letsencrypt.org/), obtener certificados SSL/TLS **gratuitos** es s√∫per f√°cil. ¬°Act√≠valo ya!
- **Evita ataques "Man-in-the-Middle":** Sin SSL/TLS, un atacante podr√≠a interceptar la comunicaci√≥n y robar datos o hacer cosas peores. ¬°No te arriesgues!

## C - üïµÔ∏è Compara Secretos y Hashes de Forma Segura

#### 1. **Definici√≥n:**

Cuando comparas contrase√±as, tokens u otros secretos, ¬°no uses `==` o `===`! Estos operadores normales pueden ser vulnerables a ataques de "tiempo". Usa `crypto.timingSafeEqual()` de Node.js.

#### 2. **Ejemplo:**

```javascript
const crypto = require("crypto");

const secretoReal = Buffer.from("mi_secreto_super_seguro");
const secretoUsuario = Buffer.from("mi_secreto_super_seguro"); // o algo que el usuario ingres√≥

// ‚úÖ Forma SEGURA de comparar:
const sonIguales = crypto.timingSafeEqual(secretoReal, secretoUsuario);

if (sonIguales) {
  console.log("¬°Secretos coinciden!");
} else {
  console.log("¬°Secretos NO coinciden!");
}
```

#### 3. **Notas o advertencias:**

- **Ataques de "tiempo":** Los comparadores normales se detienen en cuanto encuentran una diferencia. Un atacante podr√≠a medir el tiempo que tarda la comparaci√≥n y adivinar el secreto poco a poco. `timingSafeEqual()` siempre tarda lo mismo, ¬°sin importar si los secretos coinciden o no!

## D - üé≤ Genera Strings Aleatorios Seguros

#### 1. **Definici√≥n:**

Para tokens, claves de seguridad y cosas as√≠, ¬°necesitas strings aleatorios de verdad! No uses funciones "pseudo-aleatorias" simples. Usa `crypto.randomBytes()` de Node.js. ¬°Es criptogr√°ficamente seguro!

#### 2. **Ejemplo:**

```javascript
const crypto = require("crypto");

crypto.randomBytes(20, (err, buffer) => {
  if (err) {
    console.error("¬°Error al generar bytes aleatorios!", err);
    return;
  }
  const tokenSeguro = buffer.toString("hex"); // Convertir bytes a string hexadecimal
  console.log("Token seguro generado:", tokenSeguro);
});
```

#### 3. **Notas o advertencias:**

- **Aleatoriedad de verdad:** `crypto.randomBytes()` usa fuentes de aleatoriedad del sistema operativo, que son mucho m√°s seguras que los generadores pseudo-aleatorios t√≠picos.
- **¬°No inventes la rueda!** No intentes crear tu propia funci√≥n para generar strings aleatorios seguros. ¬°Usa `crypto.randomBytes()` y olv√≠date de problemas!

---

## E - üõ°Ô∏è OWASP A2: Autenticaci√≥n Rota

#### 1. **Definici√≥n:**

La autenticaci√≥n es c√≥mo verificas que un usuario es quien dice ser. "Autenticaci√≥n rota" significa que hay fallos en este proceso, ¬°y los atacantes pueden colarse como si fueran usuarios leg√≠timos!

#### 2. **Medidas clave:**

- **MFA/2FA:** Autenticaci√≥n Multi-Factor o de Dos Factores. Pide algo m√°s que solo la contrase√±a (ej: c√≥digo del m√≥vil). ¬°S√∫per recomendable para cuentas importantes!
- **Rota contrase√±as y claves:** Cambia las contrase√±as y claves de acceso regularmente, ¬°incluidas las claves SSH!
- **Pol√≠ticas de contrase√±as fuertes:** Obliga a los usuarios a usar contrase√±as dif√≠ciles de adivinar (largas, con may√∫sculas, min√∫sculas, n√∫meros, s√≠mbolos). [üîó Recomendaciones OWASP](https://www.owasp.org/index.php/Authentication_Cheat_Sheet#Implement_Proper_Password_Strength_Controls.22)
- **¬°No contrase√±as por defecto!** Nunca, jam√°s, env√≠es tu aplicaci√≥n con contrase√±as predefinidas, ¬°especialmente para administradores!
- **Autenticaci√≥n est√°ndar:** Usa m√©todos probados y seguros como OAuth, OpenID Connect. ¬°Evita la autenticaci√≥n b√°sica!
- **L√≠mite de intentos de login:** Bloquea temporalmente a usuarios que intentan entrar muchas veces con contrase√±as incorrectas.
- **Mensajes de error gen√©ricos:** Si falla el login, no digas si el usuario o la contrase√±a son incorrectos. Solo un error gen√©rico. As√≠ evitas dar pistas a atacantes.
- **Gesti√≥n centralizada de usuarios:** Si tienes muchos servicios, usa un sistema central para gestionar usuarios (ej: GitHub, AWS IAM). ¬°M√°s f√°cil y seguro!

## F - üîë OWASP A5: Control de Acceso Roto

#### 1. **Definici√≥n:**

El control de acceso es qui√©n puede hacer qu√© en tu aplicaci√≥n. "Control de acceso roto" significa que usuarios pueden acceder a cosas que no deber√≠an, ¬°como si tuvieran permisos de administrador sin serlo!

#### 2. **Medidas clave:**

- **Principio de m√≠nimo privilegio:** Cada usuario y componente solo debe tener acceso a lo **estrictamente necesario**. ¬°Nada m√°s!
- **¬°Nunca uses la cuenta root/admin directamente!** Solo para tareas de administraci√≥n de cuentas. Para todo lo dem√°s, usa cuentas con menos permisos.
- **Roles/cuentas de servicio:** Ejecuta tus aplicaciones con cuentas de servicio que tengan permisos limitados, no con cuentas de usuario normales.
- **Permisos por grupos, no por usuarios:** Asigna permisos a grupos de usuarios (ej: "administradores", "editores"). ¬°M√°s f√°cil de gestionar!

## G - ‚öôÔ∏è OWASP A6: Mala Configuraci√≥n de Seguridad

#### 1. **Definici√≥n:**

Configurar mal tu servidor, red o aplicaci√≥n puede abrir agujeros de seguridad. "Mala configuraci√≥n" es como dejar ventanas abiertas en tu casa.

#### 2. **Medidas clave:**

- **Acceso interno solo por red interna:** El acceso a partes internas de tu sistema (producci√≥n, bases de datos) solo debe ser posible desde la red interna (ej: SSH). ¬°Nunca expongas servicios internos a internet directamente!
- **Restringe la red interna:** Define qu√© recursos pueden acceder a otros dentro de tu red interna (ej: pol√≠ticas de red, subredes).
- **Cookies seguras:** Si usas cookies:
  - `Secure`: Solo se env√≠an por HTTPS.
  - `SameSite`: Solo se env√≠an si la petici√≥n viene del mismo dominio.
  - `HttpOnly`: JavaScript no puede acceder a ellas.
- **VPCs protegidas:** Usa reglas de acceso estrictas para tus VPCs (Virtual Private Clouds).
- **Modelado de amenazas:** Usa t√©cnicas como STRIDE o DREAD para identificar y priorizar amenazas de seguridad.
- **Protecci√≥n DDoS:** Usa balanceadores de carga HTTP(S) y TCP para protegerte de ataques de denegaci√≥n de servicio (DDoS).
- **Tests de penetraci√≥n:** Contrata empresas especializadas para que hagan "pruebas de ataque" a tu sistema y encuentren vulnerabilidades.

## H - üîí OWASP A3: Exposici√≥n de Datos Sensibles

#### 1. **Definici√≥n:**

Proteger datos sensibles (contrase√±as, datos personales, etc.) es crucial. "Exposici√≥n de datos sensibles" significa que estos datos se filtran o se guardan de forma insegura.

#### 2. **Medidas clave:**

- **Solo HTTPS:** ¬°Obliga a usar conexiones HTTPS! Usa cabeceras `Strict-Transport-Security` (HSTS) para asegurarte de que los navegadores siempre usen HTTPS.
- **Segmenta la red:** Divide tu red en partes (subredes) y limita el acceso entre ellas.
- **Redes privadas:** Pon los servicios que no necesitan internet en redes privadas sin conexi√≥n saliente a internet.
- **Vaults de secretos:** Guarda secretos (claves API, contrase√±as de bases de datos) en "vaults" seguros como AWS KMS, HashiCorp Vault, Google Cloud KMS.
- **Metadatos de instancias seguros:** Protege los metadatos de tus instancias en la nube para que no sean accesibles desde fuera.
- **Cifra datos en tr√°nsito:** Cifra los datos cuando salen de tu red f√≠sica.
- **¬°No secretos en logs!** Nunca, jam√°s, incluyas secretos en los logs de tu aplicaci√≥n.
- **No contrase√±as en texto plano:** No muestres contrase√±as sin encriptar en la interfaz de usuario. ¬°Y nunca guardes informaci√≥n sensible en texto plano en la base de datos!

## I - üõ†Ô∏è OWASP A9: Componentes con Vulnerabilidades Conocidas

#### 1. **Definici√≥n:**

Usar librer√≠as, frameworks o software con vulnerabilidades de seguridad conocidas es peligroso. "Componentes vulnerables" son como piezas defectuosas en tu casa.

#### 2. **Medidas clave:**

- **Escanea im√°genes Docker:** Busca vulnerabilidades en tus im√°genes Docker con herramientas como las de Docker Hub u otros proveedores.
- **Parches y actualizaciones autom√°ticas:** Activa las actualizaciones autom√°ticas de tu sistema operativo y software para tener siempre las √∫ltimas versiones con parches de seguridad.
- **Tokens de corta duraci√≥n y refresh tokens:** Usa tokens de acceso que duren poco tiempo y "refresh tokens" para renovarlos sin que el usuario tenga que volver a loguearse.
- **Logs y auditor√≠a de APIs:** Registra y audita cada llamada a APIs de la nube y servicios de gesti√≥n (ej: qui√©n borr√≥ un bucket de S3). Usa servicios como AWS CloudTrail.
- **Security Checkers de proveedores cloud:** Usa las herramientas de seguridad que te ofrece tu proveedor de nube (ej: AWS Security Trust Advisor).

## J - üìù OWASP A10: Logging y Monitorizaci√≥n Insuficientes

#### 1. **Definici√≥n:**

Si no registras y monitorizas bien lo que pasa en tu aplicaci√≥n, no te dar√°s cuenta si hay ataques o problemas de seguridad. "Logging y monitorizaci√≥n insuficientes" es como no tener c√°maras de seguridad en casa.

#### 2. **Medidas clave:**

- **Alertas por eventos sospechosos:** Configura alertas para eventos importantes como logins de usuarios, creaci√≥n de usuarios nuevos, cambios de permisos, etc.
- **Alertas por fallos de login:** Alerta si hay muchos intentos fallidos de login seguidos.
- **Auditor√≠a en la base de datos:** Guarda en cada registro de la base de datos qui√©n y cu√°ndo hizo cambios.

## K - üé≠ OWASP A7: Cross-Site Scripting (XSS)

#### 1. **Definici√≥n:**

XSS es un tipo de ataque donde un atacante "inyecta" c√≥digo JavaScript malicioso en tu sitio web. Cuando otros usuarios visitan el sitio, ese c√≥digo se ejecuta en sus navegadores, ¬°y el atacante puede robar informaci√≥n o hacer cosas malas!

#### 2. **Medidas clave:**

- **Templating engines con escape autom√°tico:** Usa motores de plantillas (como EJS, Pug, React, Angular) que escapen autom√°ticamente el contenido para evitar XSS por defecto. ¬°Pero ojo! Conoce las limitaciones de cada uno.
- **Escapa datos de peticiones HTTP:** Escapa los datos que recibes de peticiones HTTP antes de mostrarlos en HTML (en el body, atributos, JavaScript, CSS, URLs). ¬°Esto evita XSS reflejado y almacenado!
- **Codificaci√≥n sensible al contexto en el cliente:** Si modificas el DOM (Document Object Model) en el navegador con JavaScript, usa codificaci√≥n sensible al contexto para evitar XSS en el DOM.
- **Content-Security Policy (CSP):** Activa CSP. Es una cabecera HTTP que le dice al navegador qu√© recursos puede cargar y de d√≥nde. ¬°Una defensa extra contra XSS!

## L - üë§ Protege la Informaci√≥n Personal Identificable (PII)

#### 1. **Definici√≥n:**

PII son datos que pueden identificar a una persona (nombre, email, DNI, etc.). ¬°Hay que protegerlos muy bien!

#### 2. **Medidas clave:**

- **Cifra la PII:** Encripta la informaci√≥n personal en tus aplicaciones.
- **Cumple las leyes de privacidad:** Sigue las leyes de protecci√≥n de datos de tu pa√≠s o regi√≥n (ej: GDPR en Europa).
  - [GDPR (UE)](https://ec.europa.eu/info/law/law-topic/data-protection_en)
  - [Ley de India](https://meity.gov.in/writereaddata/files/Personal_Data_Protection_Bill,2018.pdf)
  - [Ley de Singapur](https://www.pdpc.gov.sg/Overview-of-PDPA/The-Legislation/Personal-Data-Protection-Act)

## M - üìÑ Ten un Fichero `security.txt` \[PRODUCCI√ìN]

#### 1. **Definici√≥n:**

Crea un fichero `security.txt` en la ra√≠z de tu sitio web (`/.well-known/security.txt` o `/security.txt`). En √©l, pon informaci√≥n de contacto para que investigadores de seguridad puedan reportarte vulnerabilidades.

#### 2. **Ejemplo:**

```
# Contact information
Contact: mailto:security@mi-sitio.com
```

#### 3. **Notas o advertencias:**

- **¬°Te avisar√°n de vulnerabilidades!** Si alguien encuentra un fallo de seguridad en tu sitio, sabr√° a qui√©n contactar f√°cilmente. ¬°As√≠ puedes arreglarlo r√°pido!
- [üîó M√°s info sobre `security.txt`](https://securitytxt.org/)

## N - üõ°Ô∏è Ten un Fichero `SECURITY.md` \[C√ìDIGO ABIERTO]

#### 1. **Definici√≥n:**

Si tu proyecto es de c√≥digo abierto, crea un fichero `SECURITY.md` en la ra√≠z, en la carpeta `docs` o `.github` de tu repositorio. Explica c√≥mo la gente puede reportar vulnerabilidades de forma responsable.

#### 2. **Ejemplo:**

```markdown
# Pol√≠tica de Seguridad

Si encuentras una vulnerabilidad de seguridad, por favor, cont√°ctanos en security@mi-proyecto.org.

Agradecemos tu colaboraci√≥n para mantener este proyecto seguro.
```

#### 3. **Notas o advertencias:**

- **Comunidad m√°s segura:** Anima a la comunidad a reportar problemas de seguridad. ¬°Entre todos, el c√≥digo ser√° m√°s robusto!
- [üîó M√°s info sobre `SECURITY.md`](https://help.github.com/en/github/managing-security-vulnerabilities/adding-a-security-policy-to-your-repository)
