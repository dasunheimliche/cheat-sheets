## A - HTTP/2: El Protocolo Veloz

#### 1. **Definición:**

HTTP/2 es la versión más moderna del protocolo que usa internet para transferir páginas web (HTTP). Imagina que es como una autopista más rápida para tus datos web, basada en una idea de Google llamada SPDY. Hace que todo vaya más fluido y rápido.

#### 2. **Características Clave:**

- **Protocolo Binario:** En lugar de texto como el antiguo HTTP/1.x, HTTP/2 usa código binario. Es como si enviaras la información en un paquete comprimido y más eficiente, reduciendo errores.
- **Streams Multiplexados:** Piensa en una tubería de agua gigante donde puedes enviar muchos archivos a la vez, en lugar de uno por uno. ¡Así es HTTP/2! Transfiere múltiples archivos en un solo flujo de datos.
- **Cabeceras Comprimidas:** Las "cabeceras" son como las etiquetas de los paquetes de datos. HTTP/2 las comprime para que sean más pequeñas y viajen más rápido.
- **Server Push (Empuje del Servidor):** El servidor es proactivo y envía al navegador los recursos que sabe que va a necesitar, ¡antes de que se los pida! Es como si el servidor adivinara el futuro para acelerar la carga.
- **Priorización de Streams:** Puedes decirle a HTTP/2 qué archivos son más importantes (por ejemplo, el texto principal primero, las imágenes después). Así, el ancho de banda se usa de forma más inteligente.

#### 3. **Ejemplo Mental:**

Imagina que pides un menú en un restaurante (HTTP/1.x). Pides la bebida, esperas, pides el primer plato, esperas, pides el segundo... ¡Qué lento! Con HTTP/2, es como si pudieras pedir todo a la vez y te lo trajeran casi simultáneamente, ¡y además la comanda está súper comprimida para que el camarero la entienda rapidísimo!

#### 4. **Nota:**

Aunque HTTP/2 es genial, no todos los sitios web lo usan todavía. ¡Pero tú puedes ser de los primeros en adoptarlo!

---

## B - Configurando SSL: ¡HTTPS para la Seguridad!

#### 1. **Definición:**

SSL (Secure Sockets Layer) es la tecnología que pone el candadito verde en tu navegador y cambia "HTTP" a "HTTPS". Esencialmente, cifra la conexión entre el navegador del usuario y tu servidor para que la información viaje segura y nadie pueda espiarla. Necesitas un **certificado SSL** para esto.

#### 2. **Certificados SSL y Let's Encrypt:**

Un **certificado SSL** es como un carnet de identidad para tu sitio web, que dice "este sitio es quien dice ser y es seguro". Normalmente, estos certificados los emiten entidades que cobran, pero **Let's Encrypt** es una organización sin ánimo de lucro que los da ¡gratis!

#### 3. **Certbot: Tu Asistente para SSL:**

**Certbot** es una herramienta mágica que te ayuda a conseguir e instalar certificados SSL de Let's Encrypt de forma súper fácil.

#### 4. **Instalando Certbot (Ubuntu Ejemplo):**

Si usas Ubuntu (como en el ejemplo del texto), la forma recomendada es con `snap`:

```bash
sudo snap install --classic certbot
```

Esto instala Certbot. Para verificar que todo está bien, puedes probar la versión:

```bash
certbot --version
```

Deberías ver la versión de Certbot instalada.

#### 5. **Obteniendo un Certificado SSL con Certbot:**

Antes de pedir el certificado, asegúrate de que tu archivo de configuración de NGINX (`/etc/nginx/sites-available/default` en el ejemplo) tiene bien puesto el `server_name` (tu dominio o IP).

Para pedir e instalar el certificado, usa este comando:

```bash
sudo certbot --nginx
```

Certbot te hará algunas preguntas (email, aceptar términos, etc.) y luego te preguntará para qué nombres de dominio quieres el certificado. ¡Selecciona el tuyo!

#### 6. **Verificando HTTPS:**

Si todo va bien, Certbot te felicitará. Abre tu navegador y visita tu sitio web con `https://` delante. ¡Deberías ver el candadito verde!

![Imagen](https://www.freecodecamp.org/news/content/images/2021/05/mCbapBf9n.jpg)

#### 7. **Renovación Automática:**

Los certificados de Let's Encrypt duran 90 días. ¡Pero no te preocupes! Certbot se encarga de renovarlos automáticamente. Puedes simular una renovación para probar que funciona con:

```bash
sudo certbot renew --dry-run
```

#### 8. **Qué Cambió Certbot en tu Configuración NGINX:**

Certbot modifica tu archivo `/etc/nginx/sites-available/default`. Mira los cambios:

```nginx
server {

    server_name nginx-handbook.farhan.dev;

    root /srv/nginx-handbook-projects/static-demo;

    listen [::]:443 ssl ipv6only=on; # managed by Certbot
    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/nginx-handbook.farhan.dev/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/nginx-handbook.farhan.dev/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

}
server {
    if ($host = nginx-handbook.farhan.dev) {
        return 301 https://$host$request_uri;
    } # managed by Certbot


    listen 80;
    listen [::]:80;

    server_name nginx-handbook.farhan.dev;
    return 404; # managed by Certbot
}
```

- **`listen 443 ssl;`**: Le dice a NGINX que escuche peticiones HTTPS en el puerto 443 (el puerto estándar para HTTPS).
- **`ssl_certificate` y `ssl_certificate_key`**: Indican dónde están guardados tu certificado y la clave privada.
- **`include /etc/letsencrypt/options-ssl-nginx.conf;`**: Incluye configuraciones SSL recomendadas.
- **`ssl_dhparam`**: Configuración para el intercambio de claves Diffie-Hellman (seguridad extra).
- **Segundo bloque `server`**: Redirige automáticamente cualquier petición HTTP (puerto 80) a HTTPS, ¡para que todo sea seguro!

---

## C - Activando HTTP/2: ¡Aún Más Rápido!

#### 1. **Requisito:**

¡Necesitas tener SSL (HTTPS) configurado para usar HTTP/2! La seguridad es obligatoria para HTTP/2.

#### 2. **Módulo `ngx_http_v2_module`:**

NGINX usa un módulo llamado `ngx_http_v2_module` para HTTP/2. Normalmente ya viene incluido en NGINX, ¡así que no te preocupes por instalarlo!

#### 3. **Verificando el Protocolo Actual (HTTP/1.1):**

Antes de activar HTTP/2, comprueba qué protocolo estás usando ahora. Puedes usar `curl`:

```bash
curl -I -L https://nginx-handbook.farhan.dev
```

Deberías ver algo como `HTTP/1.1 200 OK`, indicando que estás usando HTTP/1.1.

#### 4. **Activando HTTP/2 en la Configuración:**

Abre de nuevo tu archivo `/etc/nginx/sites-available/default`. Busca las líneas `listen 443 ssl;` y cámbialas a:

```nginx
listen 443 ssl http2;
```

Y si tienes la línea IPv6, cambia `listen [::]:443 ssl ipv6only=on;` a:

```nginx
listen [::]:443 ssl http2 ipv6only=on;
```

¡Añadimos `http2` al final de las líneas `listen 443 ssl`!

#### 5. **Probando la Configuración y Recargando NGINX:**

```bash
sudo nginx -t
sudo nginx -s reload
```

#### 6. **Verificando HTTP/2:**

Vuelve a usar `curl` para comprobar el protocolo:

```bash
curl -I -L https://nginx-handbook.farhan.dev
```

¡Ahora deberías ver `HTTP/2 200`! ¡Felicidades, tu servidor está usando HTTP/2!

---

## D - Server Push: ¡El Servidor se Anticipa!

#### 1. **Definición:**

**Server Push** es una característica de HTTP/2 donde el servidor puede "empujar" archivos al navegador sin que el navegador los pida explícitamente. Es como si el servidor dijera "sé que vas a necesitar esto también" y te lo enviara a la vez.

#### 2. **Ejemplo Práctico:**

Cuando un navegador pide un archivo `index.html`, el servidor, en lugar de solo enviar `index.html`, también puede enviar automáticamente `style.css` y `image.jpg` si sabe que `index.html` los necesita. ¡Menos peticiones, carga más rápida!

![Imagen](https://www.freecodecamp.org/news/content/images/2021/05/f49aVyg9h.jpg)
_HTTP/1.x: El navegador pide cada archivo por separado._

![Imagen](https://www.freecodecamp.org/news/content/images/2021/05/wLod0KcsB.jpg)
_HTTP/2 con Server Push: El servidor envía varios archivos a la vez._

#### 3. **Herramienta `nghttp2-client` para Probar Server Push:**

Vamos a usar una herramienta llamada `nghttp2-client` para ver Server Push en acción. Instálala:

```bash
sudo apt install nghttp2-client -y
```

Verifica la instalación:

```bash
nghttp --version
```

#### 4. **Probando Sin Server Push:**

Primero, probemos sin Server Push para ver la diferencia. Usa `nghttp` para pedir `index.html`:

```bash
nghttp --null-out --stat https://nginx-handbook.farhan.dev/index.html
```

Esto solo pide `index.html`. Ahora, pidamos `index.html` y también sus "assets" (css, imágenes, etc.) con `--get-assets`:

```bash
nghttp --null-out --stat --get-assets https://nginx-handbook.farhan.dev/index.html
```

Verás que en el segundo comando, se piden y descargan también `mini.min.css` y `the-nginx-handbook.jpg` después de `index.html`.

#### 5. **Activando Server Push en NGINX:**

Abre tu archivo `/etc/nginx/sites-available/default` y añade bloques `location` para activar Server Push para `index.html` y `about.html`:

```nginx
server {
    # ... (configuración anterior) ...

    location = /index.html {
        http2_push /mini.min.css;
        http2_push /the-nginx-handbook.jpg;
    }

    location = /about.html {
        http2_push /mini.min.css;
        http2_push /the-nginx-handbook.jpg;
    }

}
# ... (resto de la configuración) ...
```

`http2_push /mini.min.css;` y `http2_push /the-nginx-handbook.jpg;` le dicen a NGINX que "empuje" estos archivos cuando se pida `/index.html` o `/about.html`.

#### 6. **Probando Server Push Activado:**

Recarga NGINX:

```bash
sudo nginx -t
sudo nginx -s reload
```

Ahora, vuelve a usar `nghttp` para pedir solo `index.html`, ¡**sin** `--get-assets`!:

```bash
nghttp --null-out --stat https://nginx-handbook.farhan.dev/index.html
```

¡Verás que, aunque solo pediste `index.html`, el servidor también envió `mini.min.css` y `the-nginx-handbook.jpg`! ¡Server Push en acción! Fíjate en los tiempos, ¡todo debería cargar casi a la vez!

#### 7. **Nota:**

Este es un ejemplo sencillo de Server Push. Puedes configurarlo de forma más compleja según las necesidades de tu sitio web.
