## A - Reseteando el Estado de un Único Store

#### 1. **Definición:**

La forma más sencilla de resetear el estado de un store de Zustand es definir un **estado inicial** y una función **`reset`** dentro de la definición de tu store. Esta función `reset` simplemente vuelve a establecer el estado del store a su valor inicial. ¡Es como presionar el botón de "reinicio"! ⏪

#### 2. **Ejemplo:**

```typescript
import { create } from "zustand";

// Define tipos para el estado y las acciones por separado
type State = {
  salmon: number;
  tuna: number;
};

type Actions = {
  addSalmon: (qty: number) => void;
  addTuna: (qty: number) => void;
  reset: () => void; // ¡Acción para resetear!
};

// Define el estado inicial
const initialState: State = {
  salmon: 0,
  tuna: 0,
};

// Crea el store
const useSlice = create<State & Actions>()((set, get) => ({
  ...initialState, // Usa el estado inicial aquí
  addSalmon: (qty: number) => {
    set({ salmon: get().salmon + qty });
  },
  addTuna: (qty: number) => {
    set({ tuna: get().tuna + qty });
  },
  reset: () => {
    set(initialState); // ¡Función reset que usa el estado inicial!
  },
}));
```

**Explicación del ejemplo:**

- **`initialState`:** Definimos una constante `initialState` que guarda el valor inicial de nuestro estado (`salmon: 0, tuna: 0`).
- **`reset: () => { set(initialState); }`:** Añadimos una función `reset` a nuestro store. Cuando llamas a `reset()`, usamos `set(initialState)` para establecer el estado del store directamente al valor de `initialState`. ¡Así de fácil! ✨

#### 3. **Notas o advertencias:**

- **Estado inicial centralizado:** Definir `initialState` por separado hace que sea muy claro cuál es el estado inicial de tu store y facilita la función `reset`. ¡Es una buena práctica para la organización! 🗂️
- **Llama a `useSlice.getState().reset()`:** Para resetear el estado, simplemente obtén la función `reset` del store usando `useSlice.getState().reset()` y llámala. ¡Tu store volverá a su estado original! 🪄

## B - Reseteando Múltiples Stores a la Vez

#### 1. **Definición:**

Si tienes múltiples stores de Zustand y quieres resetearlos todos juntos (por ejemplo, al hacer pruebas o al cerrar sesión en una aplicación), puedes crear una función `create` personalizada que rastree todos los stores y te permita resetearlos todos con una sola llamada. ¡Es como tener un botón de "resetear todo" para tus stores! 💣

#### 2. **Ejemplo:**

```typescript
import type { StateCreator } from "zustand";
import { create as actualCreate } from "zustand";

const storeResetFns = new Set<() => void>(); // Guarda funciones de reset aquí

const resetAllStores = () => {
  storeResetFns.forEach((resetFn) => {
    resetFn(); // Llama a la función reset de cada store
  });
};

export const create = (<T>() => {
  // ¡Sobreescribe la función `create`!
  return (stateCreator: StateCreator<T>) => {
    const store = actualCreate(stateCreator); // Usa la función `create` original de Zustand
    const initialState = store.getInitialState();
    storeResetFns.add(() => {
      // Añade una función reset para este store al Set
      store.setState(initialState, true); // `true` para reemplazar el estado completamente
    });
    return store;
  };
}) as typeof actualCreate; // ¡Asegura que nuestro `create` personalizado tenga el mismo tipo que el original!
```

**Explicación del ejemplo:**

- **`storeResetFns = new Set<() => void>()`:** Creamos un `Set` llamado `storeResetFns` para guardar las funciones de reset de cada store que creemos con nuestro `create` personalizado. Un `Set` es útil porque solo guarda valores únicos y facilita iterar sobre ellos. 🧰
- **`resetAllStores = () => { ... }`:** Esta función itera sobre todas las funciones de reset guardadas en `storeResetFns` y las llama. ¡Esto resetea todos los stores a la vez! 💥
- **`export const create = (<T>() => { ... }) as typeof actualCreate;`:** Aquí "sobreescribimos" la función `create` de Zustand con nuestra propia versión personalizada.
  - Dentro de nuestro `create` personalizado, llamamos a la función `create` _original_ de Zustand (`actualCreate`) para crear el store normalmente.
  - Obtenemos el estado inicial del store con `store.getInitialState()`.
  - Añadimos una nueva función de reset al `storeResetFns`. Esta función, cuando se llama, usa `store.setState(initialState, true)` para resetear el estado de _este_ store específico a su estado inicial. El argumento `true` en `setState` es importante: le dice a Zustand que _reemplace_ el estado completamente, en lugar de hacer un "merge" superficial.
  - Devolvemos el store creado.
  - `as typeof actualCreate` asegura que nuestro `create` personalizado tenga exactamente el mismo tipo que la función `create` original de Zustand, ¡para que TypeScript no se queje! 🛡️

#### 3. **Notas o advertencias:**

- **Sobreescribiendo `create`:** Este patrón "sobreescribe" la función `create` de Zustand. Esto significa que en los archivos donde importes este `create` personalizado, ¡estarás usando _tu_ versión, no la original de Zustand! Asegúrate de entender las implicaciones de esto. ⚠️
- **`storeResetFns` guarda las funciones reset:** El `Set` `storeResetFns` es la clave para rastrear y resetear todos los stores. Cada vez que usas tu `create` personalizado, se añade una nueva función reset a este `Set`. 🔑
- **Llama a `resetAllStores()`:** Para resetear _todos_ los stores a la vez, simplemente llama a la función `resetAllStores()`. ¡Todos los stores creados con tu `create` personalizado volverán a su estado inicial! 🪄
