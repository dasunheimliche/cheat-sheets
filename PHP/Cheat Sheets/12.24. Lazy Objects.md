## A - Objetos Perezosos

**Definición:** Un objeto perezoso es un objeto cuya inicialización se difiere hasta que su estado es observado o modificado.

**Ejemplo:**

```php
class Example {
    public function __construct(public int $prop) {
        echo __METHOD__, "\n";
    }
}

$reflector = new ReflectionClass(Example::class);
$lazyObject = $reflector->newLazyGhost(function (Example $object) {
    $object->__construct(1);
});

var_dump($lazyObject);
var_dump(get_class($lazyObject));
var_dump($lazyObject->prop);
```

**Descripción del ejemplo:** En este ejemplo, se crea un objeto perezoso de la clase Example. La inicialización del objeto se difiere hasta que se accede a la propiedad prop.

## B - Estrategias de Objetos Perezosos

**Definición:** Existen dos estrategias para objetos perezosos: Objetos Fantasma y Proxies Virtuales. Los objetos fantasma se inicializan en el lugar y son indistinguibles de los objetos no perezosos una vez inicializados. Los proxies virtuales actúan como intermediarios para una instancia real.

**Ejemplo:**

```php
class Example {
    public function __construct(public int $prop) {
        echo __METHOD__, "\n";
    }
}

$reflector = new ReflectionClass(Example::class);
$lazyProxy = $reflector->newLazyProxy(function (Example $object) {
    return new Example(1);
});

var_dump($lazyProxy);
var_dump(get_class($lazyProxy));
var_dump($lazyProxy->prop);
```

**Descripción del ejemplo:** En este ejemplo, se crea un proxy perezoso de la clase Example. La inicialización del objeto real se difiere hasta que se accede a la propiedad prop.

## C - Inicialización de Propiedades

**Definición:** Es posible inicializar propiedades de un objeto perezoso sin desencadenar la inicialización completa del objeto.

**Ejemplo:**

```php
class BlogPost {
    public function __construct(public int $id, public string $title, public string $content) {}
}

$reflector = new ReflectionClass(BlogPost::class);
$post = $reflector->newLazyGhost(function ($post) {
    $data = fetch_from_store($post->id);
    $post->__construct($data['id'], $data['title'], $data['content']);
});

$reflector->getProperty('id')->skipLazyInitialization($post);
$reflector->getProperty('id')->setValue($post, 123);

var_dump($post->id);
```

**Descripción del ejemplo:** En este ejemplo, la propiedad id del objeto BlogPost se inicializa sin desencadenar la inicialización completa del objeto.

## D - Ciclo de Vida de los Objetos Perezosos

**Definición:** Los objetos perezosos pueden ser inicializados en el momento de la instanciación o después de la instanciación. La inicialización se desencadena mediante operaciones que observan o modifican el estado del objeto.

**Ejemplo:**

```php
class Example {
    public function __construct(public int $prop) {
        echo __METHOD__, "\n";
    }
}

$reflector = new ReflectionClass(Example::class);
$lazyObject = $reflector->newLazyGhost(function (Example $object) {
    $object->__construct(1);
});

$lazyObject->prop; // Desencadena la inicialización
```

**Descripción del ejemplo:** En este ejemplo, la inicialización del objeto perezoso se desencadena al acceder a la propiedad prop.

## E - Clonación de Objetos Perezosos

**Definición:** Clonar un objeto perezoso desencadena su inicialización antes de que se cree el clon.

**Ejemplo:**

```php
class Example {
    public function __construct(public int $prop) {
        echo __METHOD__, "\n";
    }
}

$reflector = new ReflectionClass(Example::class);
$lazyObject = $reflector->newLazyGhost(function (Example $object) {
    $object->__construct(1);
});

$clone = clone $lazyObject;
```

**Descripción del ejemplo:** En este ejemplo, la clonación del objeto perezoso desencadena su inicialización antes de que se cree el clon.
